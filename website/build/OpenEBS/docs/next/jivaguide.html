<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Jiva user guide · </title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta property="og:title" content="Jiva user guide · "/><meta property="og:type" content="website"/><meta property="og:url" content="https://docs.openebs.io/index.html"/><meta property="og:description" content="------"/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/img/favicon.ico"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="stylesheet" href="/css/code-blocks-buttons.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/js/code-blocks-buttons.js"></script><link rel="stylesheet" href="/css/main.css"/></head><body class="sideNavVisible doc separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img id="logo" src="/img/OpenEBS-logo.svg" alt=""/><img class="logo-text" src="/img/openebs-docs-logo.svg" alt=""/><h2 class="headerTitle"></h2></a><div class="dropdown"><span class="ver-link">0.8.1</span><span class="ver-link-span"><i class="arrow down"></i></span><div class="dropdown-menu" id="versions-list" aria-labelledby="dropdownMenuButton"><a class="dropdown-item" id="0" href="https://docs.openebs.io">0.8.1</a><a class="dropdown-item" id="1" href="https://v08-docs.openebs.io">0.8.0</a><a class="dropdown-item" id="2" href="https://v07-docs.openebs.io">0.7.0</a><a class="dropdown-item" id="3" href="https://v06-docs.openebs.io">0.6.0</a><a class="dropdown-item" id="4" href="https://v05-docs.openebs.io">0.5.0</a></div></div><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><a href="https://app.mayaonline.io" target="_blank" rel="noreferrer noopener"><div class="float rotate"><img src="../../../../../../docs/assets/mo-logo.png" alt="MayaOnline" height="45px" width="45px" title="Connect to MayaOnline"/></div></a><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>User Guides</span></h2></div><div class="navGroups"><div class="navGroup navGroupActive"><h3 id="Introduction" class="languages-menu">Introduction</h3><div class="hide" id="Introduction dropdown-content-div"><ul id="languages-dropdown-items"><li class="navListItem"><a class="navItem" href="/docs/next/overview.html">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/next/features.html">Features and Benefits</a></li><li class="navListItem"><a class="navItem" href="/docs/next/usecases.html">Use cases</a></li><li class="navListItem"><a class="navItem" href="/docs/next/releases.html">Releases</a></li><li class="navListItem"><a class="navItem" href="/docs/next/support.html">Support</a></li><li class="navListItem"><a class="navItem" href="/docs/next/mayaonline.html">MayaOnline</a></li></ul></div></div><div class="navGroup navGroupActive"><h3 id="Concepts" class="languages-menu">Concepts</h3><div class="hide" id="Concepts dropdown-content-div"><ul id="languages-dropdown-items"><li class="navListItem"><a class="navItem" href="/docs/next/cas.html">Container Attached Storage</a></li><li class="navListItem"><a class="navItem" href="/docs/next/architecture.html">OpenEBS Architecture</a></li><li class="navListItem"><a class="navItem" href="/docs/next/casengines.html">CAS Engines (cStor &amp; Jiva)</a></li><li class="navListItem"><a class="navItem" href="/docs/next/cstor.html">cStor</a></li><li class="navListItem"><a class="navItem" href="/docs/next/jiva.html">Jiva</a></li></ul></div></div><div class="navGroup navGroupActive"><h3 id="User Guides" class="languages-menu">User Guides</h3><div class="hide" id="User Guides dropdown-content-div"><ul id="languages-dropdown-items"><li class="navListItem"><a class="navItem" href="/docs/next/quickstart.html">Quickstart</a></li><li class="navListItem"><a class="navItem" href="/docs/next/prerequisites.html">Prerequisites</a></li><li class="navListItem"><a class="navItem" href="/docs/next/installation.html">Installation</a></li><li class="navListItem"><a class="navItem" href="/docs/next/configurepools.html">Configure StoragePools</a></li><li class="navListItem"><a class="navItem" href="/docs/next/configuresc.html">Configuring StorageClasses</a></li><li class="navListItem"><a class="navItem" href="/docs/next/provisionvols.html">Provisioning Volumes</a></li><li class="navListItem"><a class="navItem" href="/docs/next/operations.html">Day 2 Operations</a></li><li class="navListItem navListItemActive"><a class="navItem navItemActive" href="/docs/next/jivaguide.html">Jiva user guide</a></li><li class="navListItem"><a class="navItem" href="/docs/next/mayactl.html">Mayactl</a></li><li class="navListItem"><a class="navItem" href="/docs/next/backup.html">Backup and Restore</a></li><li class="navListItem"><a class="navItem" href="/docs/next/upgrade.html">Upgrade</a></li><li class="navListItem"><a class="navItem" href="/docs/next/uninstall.html">Uninstall</a></li></ul></div></div><div class="navGroup navGroupActive"><h3 id="Stateful Applications" class="languages-menu">Stateful Applications</h3><div class="hide" id="Stateful Applications dropdown-content-div"><ul id="languages-dropdown-items"><li class="navListItem"><a class="navItem" href="/docs/next/mysql.html">RDS like MySQL</a></li><li class="navListItem"><a class="navItem" href="/docs/next/prometheus.html">Prometheus</a></li><li class="navListItem"><a class="navItem" href="/docs/next/minio.html">Minio</a></li><li class="navListItem"><a class="navItem" href="/docs/next/gitlab.html">GitLab</a></li><li class="navListItem"><a class="navItem" href="/docs/next/percona.html">Percona</a></li><li class="navListItem"><a class="navItem" href="/docs/next/elasticsearch.html">ElasticSearch</a></li><li class="navListItem"><a class="navItem" href="/docs/next/cassandra.html">Cassandra</a></li><li class="navListItem"><a class="navItem" href="/docs/next/nuodb.html">NuoDB</a></li><li class="navListItem"><a class="navItem" href="/docs/next/postgres.html">PostgreSQL</a></li><li class="navListItem"><a class="navItem" href="/docs/next/redis.html">Redis</a></li><li class="navListItem"><a class="navItem" href="/docs/next/mongo.html">MongoDB</a></li><li class="navListItem"><a class="navItem" href="/docs/next/rwm.html">Read-Write-Many (RWM)</a></li></ul></div></div><div class="navGroup navGroupActive"><h3 id="Advanced Topics" class="languages-menu">Advanced Topics</h3><div class="hide" id="Advanced Topics dropdown-content-div"><ul id="languages-dropdown-items"><li class="navListItem"><a class="navItem" href="/docs/next/performance.html">Performance testing</a></li><li class="navListItem"><a class="navItem" href="/docs/next/faq.html">FAQs</a></li><li class="navListItem"><a class="navItem" href="/docs/next/k8supgrades.html">Kubernetes upgrades</a></li><li class="navListItem"><a class="navItem" href="/docs/next/troubleshooting.html">Troubleshooting</a></li></ul></div></div></div></section></div><script>
          var toggler = document.getElementById('navToggler');
          var nav = document.getElementById('docsNav');
          toggler.onclick = function() {
            nav.classList.toggle('docsSliderActive');
          };
        </script><script>
            var navGroupElem = document.getElementsByClassName("hide");
            for(var k=0; k<navGroupElem.length; k++){
              if (navGroupElem[k].innerHTML.indexOf("navItem navItemActive") != -1) {
                document.getElementById(navGroupElem[k].id).className = "visible";
              }
            }
            var elem = document.getElementsByClassName("languages-menu");
            for (var i=0; i < elem.length; i++){
              document.getElementById(String(elem[i].id)).addEventListener("click", function() {
                sessionStorage.setItem("name", document.getElementById(this.id+" dropdown-content-div").className);
                sessionStorage.setItem("Id", document.getElementById(this.id).id);
                if ( document.getElementById(this.id+" dropdown-content-div").className == "hide") {
                  document.getElementById(this.id+" dropdown-content-div").className = "visible";
                }
                else {
                  document.getElementById(this.id+" dropdown-content-div").className = "hide";
                }
            })};</script><script>
          var SelectedItemClassName = sessionStorage.getItem("name");
          var SelectedItemId = sessionStorage.getItem("Id");
          if (SelectedItemClassName == "hide"){
            document.getElementById( SelectedItemId +" dropdown-content-div").className = "visible";
          }
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/openebs/openebs-docs/edit/staging/docs/jivaguide.md" target="_blank" rel="noreferrer noopener">Edit</a><a class="edit-page-link button" href="https://github.com/openebs/openebs/issues/new/" target="_blank" rel="noreferrer noopener">Create An Issue</a><h1>Jiva user guide</h1></header><article><div><span><hr>
<p>For details of how Jiva works, see <a href="/docs/next/jiva.html" >Jiva overview page</a></p>
<p>Jiva is a light weight storage engine that is recommended to use for low capacity workloads. The snapshot and storage management features of the other cStor engine are more advanced and is <a href="http://localhost:3000/docs/next/casengines.html#cstor-vs-jiva-features-comparison">recommended</a> when snapshots are a need.</p>
<p><br></p>
<p>Follow the below steps to provision persistent volumes using Jiva storage engine.</p>
<p><a href="/docs/next/installation.html" target="_blank">Verify</a> OpenEBS installation</p>
<p><a href="/docs/next/iscsiclient.html" target="_blank">Verify</a> iSCSI client is installed and iscsid service is running</p>
<p>If simple provisioning of jiva volumes is desired without any configuration see  <a href="/docs/next/jivaguide.html#simple-provisioning-of-jiva">here</a></p>
<p>For provisioning with local or cloud disks <a href="/docs/next/jivaguide.html#provisioning-with-local-or-cloud-disks">here</a></p>
<p>For configuring different storage policies on Jiva volume, see <a href="/docs/next/jivaguide.html#jiva-storage-policies">here</a>.</p>
<p><br></p>
<h2><a class="anchor" aria-hidden="true" id="simple-provisioning-of-jiva"></a><a href="#simple-provisioning-of-jiva" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Simple provisioning of jiva</h2>
<p>To quickly provision a jiva volume using the default pool and storageClass, use the following command</p>
<pre><code class="hljs">kubectl apply -f https:<span class="hljs-regexp">//</span>raw.githubusercontent.com<span class="hljs-regexp">/openebs/</span>openebs<span class="hljs-regexp">/master/</span>k8s<span class="hljs-regexp">/demo/</span>pvc-standard-jiva-default.yaml
</code></pre>
<p>In this mode, OpenEBS provisions a jiva volume with three replicas on three different nodes. The data in each replica is storage in the local container storage of the replica itself. The data is replicated and highly available and is suitable for quick testing of OpenEBS and simple application PoCs.</p>
<h2><a class="anchor" aria-hidden="true" id="provisioning-with-local-or-cloud-disks"></a><a href="#provisioning-with-local-or-cloud-disks" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Provisioning with local or cloud disks</h2>
<p>In this mode, local disks on each node need to be prepared and mounted at a directory path for use by jiva.</p>
<p><strong><em>Note:</em></strong> Node disk manager and other disk management capabilities are integrated into and used by cStor. For jiva, the mount paths need to be setup and managed by the administrator.</p>
<h3><a class="anchor" aria-hidden="true" id="prepare-disks-and-mount-them"></a><a href="#prepare-disks-and-mount-them" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Prepare disks and mount them</h3>
<p>If is is a cloud disk provision and mount on the node. If three replicas of Jiva volume are needed, provision three cloud disks and mount them on each node. The mount path needs to be same on all three nodes</p>
<p><strong>GPD example</strong></p>
<ul>
<li><p>Create a GPD</p>
<p><font color="maroon"></p>
<p>gcloud compute disks create disk1 --size 100GB --type pd-standard  --zone us-central1-a</p>
<p></font></p></li>
<li><p>Attach the GPD to a node</p>
<p><font color="maroon"></p>
<p>gcloud compute instances attach-disk <Node Name> --disk disk1 --zone us-central1-a</p>
<p></font></p></li>
</ul>
<ul>
<li><p>If the disk attached is mapped to /dev/sdb, verify the size, mount the disk and format it</p>
<p><font color="maroon"></p>
<p>sudo lsblk -o NAME,FSTYPE,SIZE,MOUNTPOINT,LABEL</p>
<p>sudo mkfs.ext4 /dev/&lt;device-name&gt;</p>
<p>sudo mkdir /mnt/openebs-gpd</p>
<p>sudo mount /dev/sdb  /mnt/openebs-gpd</p>
<p></font></p></li>
<li><p>Repeat the above steps on other two nodes if this is a three replica case</p></li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="create-a-jiva-pool"></a><a href="#create-a-jiva-pool" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Create a Jiva pool</h3>
<p>Jiva pool requires mount path to prepared and available. Note that if the mount path is not pointing a real disk, then a local directory is created with this mount path and the replica data goes to the container image disk (similar to the case of <code>default</code> pool)</p>
<ul>
<li>YAML specification to create the jiva pool is shown below</li>
</ul>
<pre><code class="hljs"><span class="hljs-symbol">    apiVersion:</span> openebs.io/v1alpha1
<span class="hljs-symbol">    kind:</span> StoragePool
<span class="hljs-symbol">    metadata:</span>
<span class="hljs-symbol">        name:</span> gpdpool            
<span class="hljs-symbol">        type:</span> hostdir
<span class="hljs-symbol">    spec:</span>
<span class="hljs-symbol">        path:</span> <span class="hljs-string">"/mnt/openebs-gpd"</span>   
</code></pre>
<ul>
<li>Copy the above content to the into a file called jiva-gpd-pool.yaml and create the pool using the following command</li>
</ul>
<pre><code class="hljs">kubectl apply -f jiva-gpd-pool<span class="hljs-selector-class">.yaml</span> 
</code></pre>
<ul>
<li>Verify if the pool is created using the following command</li>
</ul>
<pre><code class="hljs">kubectl <span class="hljs-builtin-name">get</span> storagepool
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="create-a-storageclass"></a><a href="#create-a-storageclass" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Create a StorageClass</h3>
<p>Specify the jiva pool in the <code>StoragePool</code> annotation of storage class. Example StorageClass specification is given below</p>
<hr>
<pre><code class="hljs"><span class="hljs-attribute">apiVersion</span>: storage.k8s.io/v1
<span class="hljs-attribute">kind</span>: StorageClass
<span class="hljs-attribute">metadata</span>:
  <span class="hljs-attribute">name</span>: openebs-jiva-gpd-<span class="hljs-number">3</span>repl
  <span class="hljs-attribute">annotations</span>:
    cas.openebs.io/<span class="hljs-attribute">config</span>: |
      - <span class="hljs-attribute">name</span>: ControllerImage
        <span class="hljs-attribute">value</span>: openebs/<span class="hljs-attribute">jiva</span>:<span class="hljs-number">0.8</span>.<span class="hljs-number">1</span>
      - <span class="hljs-attribute">name</span>: ReplicaImage
        <span class="hljs-attribute">value</span>: openebs/<span class="hljs-attribute">jiva</span>:<span class="hljs-number">0.8</span>.<span class="hljs-number">1</span>
      - <span class="hljs-attribute">name</span>: VolumeMonitorImage
        <span class="hljs-attribute">value</span>: openebs/<span class="hljs-attribute">m-exporter</span>:<span class="hljs-number">0.8</span>.<span class="hljs-number">1</span>
      - <span class="hljs-attribute">name</span>: ReplicaCount
        <span class="hljs-attribute">value</span>: <span class="hljs-string">"3"</span>
      - <span class="hljs-attribute">name</span>: StoragePool
        <span class="hljs-attribute">value</span>: gpdpool
</code></pre>
<ul>
<li>Copy the above content to the into a file called jiva-gpd-3repl-sc.yaml and create the pool using the following command</li>
</ul>
<pre><code class="hljs">kubectl apply -f jiva-gpd-<span class="hljs-number">3</span>repl-sc<span class="hljs-selector-class">.yaml</span>
</code></pre>
<ul>
<li>Verify if the StorageClass is created using the following command</li>
</ul>
<pre><code class="hljs">kubectl <span class="hljs-builtin-name">get</span> sc
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="provision-jiva-volumes"></a><a href="#provision-jiva-volumes" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Provision Jiva Volumes</h3>
<p>Once the storage class is created, provision the volumes using the standard PVC interface. In the example below the <code>StorageClass</code> openebs-jiva-gpd-3repl is specified in the <code>PersistentVolumeClaim</code> specification</p>
<p><strong>Percona example</strong></p>
<pre><code class="hljs"><span class="hljs-meta">---</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">Pod</span>
<span class="hljs-attr">metadata:</span>
<span class="hljs-attr">  name:</span> <span class="hljs-string">percona</span>
<span class="hljs-attr">  labels:</span>
<span class="hljs-attr">    name:</span> <span class="hljs-string">percona</span>
<span class="hljs-attr">spec:</span>
<span class="hljs-attr">  containers:</span>
<span class="hljs-attr">  - resources:</span>
<span class="hljs-attr">      limits:</span>
<span class="hljs-attr">        cpu:</span> <span class="hljs-number">0.5</span>
<span class="hljs-attr">    name:</span> <span class="hljs-string">percona</span>
<span class="hljs-attr">    image:</span> <span class="hljs-string">percona</span>
<span class="hljs-attr">    args:</span>
<span class="hljs-bullet">      -</span> <span class="hljs-string">"--ignore-db-dir"</span>
<span class="hljs-bullet">      -</span> <span class="hljs-string">"lost+found"</span>
<span class="hljs-attr">    env:</span>
<span class="hljs-attr">      - name:</span> <span class="hljs-string">MYSQL_ROOT_PASSWORD</span>
<span class="hljs-attr">        value:</span> <span class="hljs-string">k8sDem0</span>
<span class="hljs-attr">    ports:</span>
<span class="hljs-attr">      - containerPort:</span> <span class="hljs-number">3306</span>
<span class="hljs-attr">        name:</span> <span class="hljs-string">percona</span>
<span class="hljs-attr">    volumeMounts:</span>
<span class="hljs-attr">    - mountPath:</span> <span class="hljs-string">/var/lib/mysql</span>
<span class="hljs-attr">      name:</span> <span class="hljs-string">demo-vol1</span>
<span class="hljs-attr">  volumes:</span>
<span class="hljs-attr">  - name:</span> <span class="hljs-string">demo-vol1</span>
<span class="hljs-attr">    persistentVolumeClaim:</span>
<span class="hljs-attr">      claimName:</span> <span class="hljs-string">demo-vol1-claim</span>
<span class="hljs-meta">---</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">PersistentVolumeClaim</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span>
<span class="hljs-attr">metadata:</span>
<span class="hljs-attr">  name:</span> <span class="hljs-string">demo-vol1-claim</span>
<span class="hljs-attr">spec:</span>
<span class="hljs-attr">  storageClassName:</span> <span class="hljs-string">openebs-jiva-gpd-3repl</span>
<span class="hljs-attr">  accessModes:</span>
<span class="hljs-bullet">    -</span> <span class="hljs-string">ReadWriteOnce</span>
<span class="hljs-attr">  resources:</span>
<span class="hljs-attr">    requests:</span>
<span class="hljs-attr">      storage:</span> <span class="hljs-number">5</span><span class="hljs-string">G</span>

</code></pre>
<p>Run the application using the following command.</p>
<pre><code class="hljs">kubectl <span class="hljs-built_in">apply</span> -f <span class="hljs-built_in">demo</span>-percona-mysql-pvc.yaml
</code></pre>
<p>The Percona application now runs inside the <code>gpdpool</code> storage pool.</p>
<h3><a class="anchor" aria-hidden="true" id="jiva-storage-policies"></a><a href="#jiva-storage-policies" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Jiva Storage Policies</h3>
<p>Below table lists the storage policies supported by Jiva. These policies should be built into <em>StorageClass</em> and apply them through <em>PersistentVolumeClaim</em> or <em>VolumeClaimTemplates</em> interface.</p>
<table>
<thead>
<tr><th>CSTOR STORAGE POLICY</th><th>MANDATORY</th><th>DEFAULT</th><th>PURPOSE</th></tr>
</thead>
<tbody>
<tr><td><a href="#Replica-Count-Policy">ReplicaCount</a></td><td>No</td><td>3</td><td>Defines the number of Jiva volume replicas</td></tr>
<tr><td><a href="#Replica-Image-Policy">Replica Image</a></td><td></td><td>quay.io/openebs/m-apiserver:0.8.1</td><td>To use particular Jiva replica image</td></tr>
<tr><td><a href="#Controller-Image-Policy">ControllerImage</a></td><td></td><td>quay.io/openebs/jiva:0.8.1</td><td>To use particular Jiva Controller Image</td></tr>
<tr><td><a href="#Storage-Pool-Policy">StoragePool</a></td><td>Yes</td><td>default</td><td>A storage pool provides a persistent path for an OpenEBS volume. It can be a directory on host OS or externally mounted disk.</td></tr>
<tr><td><a href="#Volume-Monitor-Policy">VolumeMonitor</a></td><td></td><td>ON</td><td>When ON, a volume exporter sidecar is launched to export Prometheus metrics.</td></tr>
<tr><td><a href="#Volume-Monitoring-Image-Policy">VolumeMonitorImage</a></td><td></td><td>quay.io/openebs/m-exporter:0.8.1</td><td>Used when VolumeMonitor is ON. A dedicated metrics exporter to the workload. Can be used to apply a specific issue or feature for the workload</td></tr>
<tr><td><a href="#Volume-File-System-Type-Policy">Volume FSType</a></td><td></td><td>ext4</td><td>Specifies the filesystem that the volume should be formatted with. Other values are <code>xfs</code></td></tr>
<tr><td><a href="#Volume-Space-Reclaim-Policy">Volume Space Reclaim</a></td><td></td><td>false</td><td>It will specify whether data need to be retained post PVC deletion.</td></tr>
<tr><td><a href="#Targe-NodeSelector-Policy">TargetNodeSelector</a></td><td></td><td>Decided by Kubernetes scheduler</td><td>Specify the label in <code>key: value</code> format to notify Kubernetes scheduler to schedule Jiva target pod on the nodes that match label.</td></tr>
<tr><td><a href="#Replica-NodeSelector-Policy">Replica NodeSelector</a></td><td></td><td>Decided by Kubernetes scheduler</td><td>Specify the label in <code>key: value</code> format to notify Kubernetes scheduler to schedule Jiva replica pods on the nodes that match label.</td></tr>
<tr><td><a href="#TargetTolerations">TargetTolerations</a></td><td></td><td>Decided by Kubernetes scheduler</td><td>Configuring the tolerations for Jiva Target pod.</td></tr>
<tr><td><a href="#ReplicaTolerations">ReplicaTolerations</a></td><td></td><td>Decided by Kubernetes scheduler</td><td>Configuring the tolerations for Jiva Replica pods.</td></tr>
<tr><td><a href="#Target-ResourceLimits-Policy">TargetResourceLimits</a></td><td></td><td>Decided by Kubernetes scheduler</td><td>CPU and Memory limits to Jiva Target pod</td></tr>
<tr><td><a href="#TargetResourceRequests">TargetResourceRequests</a></td><td></td><td>Decided by Kubernetes scheduler</td><td>Configuring resource requests that need to be available before scheduling the containers.</td></tr>
<tr><td><a href="#AuxResourceLimits-Policy">AuxResourceLimits</a></td><td></td><td>Decided by Kubernetes scheduler</td><td>configuring resource limits on the target pod.</td></tr>
<tr><td><a href="#AuxResourceRequests-Policy">AuxResourceRequests</a></td><td></td><td>Decided by Kubernetes scheduler</td><td>Configure minimum requests like ephemeral storage to avoid erroneous eviction by K8s.</td></tr>
<tr><td><a href="#ReplicaResourceLimits-Policy">ReplicaResourceLimits</a></td><td></td><td>Decided by Kubernetes scheduler</td><td>Allow you to specify resource limits for the Replica.</td></tr>
<tr><td><a href="#Target-Affinity-Policy">Target Affinity</a></td><td></td><td>Decided by Kubernetes scheduler</td><td>The policy specifies the label <code>key: value</code> pair to be used both on the Jiva target and on the application being used so that application pod and Jiva target pod are scheduled on the same node.</td></tr>
</tbody>
</table>
<p><h3><a class="anchor" aria-hidden="true" id="Replica-Count-Policy"></a>Replica Count Policy</h3></p>
<p>You can specify the Jiva replica count using the <em>value</em> for <em>ReplicaCount</em> property. In the following example, the jiva-replica-count is specified as 3. Hence, three replicas are created.</p>
<pre><code class="hljs"><span class="hljs-attribute">apiVersion</span>: storage.k8s.io/v1
<span class="hljs-attribute">kind</span>: StorageClass
<span class="hljs-attribute">metadata</span>:
  <span class="hljs-attribute">name</span>: openebs-jiva-default
  <span class="hljs-attribute">annotations</span>:
    openebs.io/<span class="hljs-attribute">cas-type</span>: jiva
    cas.openebs.io/<span class="hljs-attribute">config</span>: |
       - <span class="hljs-attribute">name</span>: ReplicaCount
         <span class="hljs-attribute">value</span>: <span class="hljs-string">"3"</span>
</code></pre>
<p><h3><a class="anchor" aria-hidden="true" id="Replica-Image-Policy"></a>Replica Image Policy</h3></p>
<p>You can specify the jiva replica image using <em>value</em> for <em>ReplicaImage</em> property.</p>
<pre><code class="hljs"><span class="hljs-attribute">apiVersion</span>: storage.k8s.io/v1
<span class="hljs-attribute">kind</span>: StorageClass
<span class="hljs-attribute">metadata</span>:
  <span class="hljs-attribute">name</span>: openebs-jiva-default
  <span class="hljs-attribute">annotations</span>:
    openebs.io/<span class="hljs-attribute">cas-type</span>: jiva
    cas.openebs.io/<span class="hljs-attribute">config</span>: |
      - <span class="hljs-attribute">name</span>: ReplicaImage
        <span class="hljs-attribute">value</span>: quay.io/openebs/<span class="hljs-attribute">m-apiserver</span>:<span class="hljs-number">0.8</span>.<span class="hljs-number">1</span>
</code></pre>
<p><h3><a class="anchor" aria-hidden="true" id="Controller-Image-Policy"></a>Controller Image Policy</h3></p>
<p>You can specify the jiva controller image using the <em>value</em> for <em>ControllerImage</em> property.</p>
<pre><code class="hljs"><span class="hljs-attribute">apiVersion</span>: storage.k8s.io/v1
<span class="hljs-attribute">kind</span>: StorageClass
<span class="hljs-attribute">metadata</span>:
  <span class="hljs-attribute">name</span>: openebs-jiva-default
  <span class="hljs-attribute">annotations</span>:
    openebs.io/<span class="hljs-attribute">cas-type</span>: jiva
    cas.openebs.io/<span class="hljs-attribute">config</span>: |
      - <span class="hljs-attribute">name</span>: ControllerImage
        <span class="hljs-attribute">value</span>: quay.io/openebs/<span class="hljs-attribute">jiva</span>:<span class="hljs-number">0.8</span>.<span class="hljs-number">1</span>
</code></pre>
<p><h3><a class="anchor" aria-hidden="true" id="Volume-Monitor-Policy"></a>Volume Monitor Policy</h3></p>
<p>You can specify the jiva volume monitor feature which can be set using <em>value</em> for <em>VolumeMonitor</em> property.</p>
<pre><code class="hljs"><span class="hljs-attribute">apiVersion</span>: storage.k8s.io/v1
<span class="hljs-attribute">kind</span>: StorageClass
<span class="hljs-attribute">metadata</span>:
  <span class="hljs-attribute">name</span>: openebs-jiva-default
  <span class="hljs-attribute">annotations</span>:
    openebs.io/<span class="hljs-attribute">cas-type</span>: jiva
    cas.openebs.io/<span class="hljs-attribute">config</span>: |
      - <span class="hljs-attribute">enabled</span>: <span class="hljs-string">"true"</span>
        <span class="hljs-attribute">name</span>: VolumeMonitor
</code></pre>
<p><h3><a class="anchor" aria-hidden="true" id="Storage-Pool-Policy"></a>Storage Pool Policy</h3></p>
<p>A storage pool provides a persistent path for an OpenEBS volume. It can be a directory on any of the following.</p>
<ul>
<li>host-os or</li>
<li>mounted disk</li>
</ul>
<p><strong>Note:</strong></p>
<p>You must define the storage pool as a Kubernetes Custom Resource (CR) before using it as a Storage Pool policy. Following is a sample Kubernetes custom resource definition for a storage pool.</p>
<pre><code class="hljs">apiVersion: openebs.io/v1alpha1
kind: StoragePool
metadata:
    name:<span class="hljs-built_in"> default
</span>    type: hostdir
spec:
    path: <span class="hljs-string">"/mnt/openebs"</span>
</code></pre>
<p>This storage pool custom resource can now be used as follows in the storage class.</p>
<pre><code class="hljs">apiVersion: storage.k8s.io/v1
kind: StorageClass
metadata:
  name: openebs-jiva-default
  annotations:
    openebs.io/cas-type: jiva
    cas.openebs.io/config: |
      - name: StoragePool
        value:<span class="hljs-built_in"> default
</span></code></pre>
<p><h3><a class="anchor" aria-hidden="true" id="Volume-File-System-Type-Policy"></a>Volume File System Type Policy</h3></p>
<p>You can specify a storage class policy where you can specify the file system type. By default, OpenEBS comes with ext4 file system. However, you can also use the xfs file system.</p>
<p>Following is a sample setting.</p>
<pre><code class="hljs"><span class="hljs-attribute">apiVersion</span>: storage.k8s.io/v1
<span class="hljs-attribute">kind</span>: StorageClass
<span class="hljs-attribute">metadata</span>:
   <span class="hljs-attribute">name</span>: openebs-mongodb
   <span class="hljs-attribute">annotations</span>:
    openebs.io/<span class="hljs-attribute">cas-type</span>: jiva
    cas.openebs.io/<span class="hljs-attribute">config</span>: |
      - <span class="hljs-attribute">name</span>: FSType
        <span class="hljs-attribute">value</span>: <span class="hljs-string">"xfs"</span>
</code></pre>
<p><h3><a class="anchor" aria-hidden="true" id="Volume-Monitoring-Image-Policy"></a>Volume Monitoring Image Policy</h3></p>
<p>You can specify the monitoring image policy for a particular volume using <em>value</em> for <em>VolumeMonitorImage</em>property. The following Kubernetes storage class sample uses the Volume Monitoring policy. By default, volume monitor is enabled.</p>
<pre><code class="hljs"><span class="hljs-attribute">apiVersion</span>: storage.k8s.io/v1
<span class="hljs-attribute">kind</span>: StorageClass
<span class="hljs-attribute">metadata</span>:
  <span class="hljs-attribute">name</span>: openebs-jiva-default
  <span class="hljs-attribute">annotations</span>:
    openebs.io/<span class="hljs-attribute">cas-type</span>: jiva
    cas.openebs.io/<span class="hljs-attribute">config</span>: |
      - <span class="hljs-attribute">name</span>: VolumeMonitorImage
        <span class="hljs-attribute">value</span>: quay.io/openebs/<span class="hljs-attribute">m-exporter</span>:<span class="hljs-number">0.8</span>.<span class="hljs-number">1</span>
</code></pre>
<p><h3><a class="anchor" aria-hidden="true" id="Volume-Space-Reclaim-Policy"></a>Volume Space Reclaim Policy</h3></p>
<p>Support for a storage policy that can disable the Jiva Volume Space reclaim. You can specify the jiva volume space reclaim feature setting using the <em>value</em> for <em>RetainReplicaData</em> property. In the following example, the jiva volume space reclaim feature is enabled as true. Hence, retain the volume data post PVC deletion.</p>
<pre><code class="hljs"><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">storage.k8s.io/v1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">StorageClass</span>
<span class="hljs-attr">metadata:</span>
<span class="hljs-attr">  name:</span> <span class="hljs-string">openebs-jiva-default</span>
<span class="hljs-attr">  annotations:</span>
    <span class="hljs-string">openebs.io/cas-type:</span> <span class="hljs-string">jiva</span>
    <span class="hljs-string">cas.openebs.io/config:</span> <span class="hljs-string">|
</span><span class="hljs-attr">      - name:</span> <span class="hljs-string">RetainReplicaData</span>
<span class="hljs-attr">        enabled:</span> <span class="hljs-literal">true</span>
</code></pre>
<p><h3><a class="anchor" aria-hidden="true" id="Targe-NodeSelector-Policy"></a>Target  NodeSelector Policy</h3></p>
<p>You can specify the <em>TargetNodeSelector</em> where Target pod has to be scheduled using the <em>value</em> for <em>TargetNodeSelector</em>. In following example, <code>node: apnode</code>is the node label.</p>
<pre><code class="hljs"><span class="hljs-attribute">apiVersion</span>: storage.k8s.io/v1
<span class="hljs-attribute">kind</span>: StorageClass
<span class="hljs-attribute">metadata</span>:
  <span class="hljs-attribute">annotations</span>:
    cas.openebs.io/<span class="hljs-attribute">config</span>: |
      - <span class="hljs-attribute">name</span>: TargetNodeSelector
        <span class="hljs-attribute">value</span>: |-
            <span class="hljs-attribute">node</span>: appnode
    openebs.io/<span class="hljs-attribute">cas-type</span>: jiva
</code></pre>
<p><h3><a class="anchor" aria-hidden="true" id="Replica-NodeSelector-Policy"></a>Replica NodeSelector Policy</h3></p>
<p>You can specify the <em>ReplicaNodeSelector</em> where replica pods has to be scheduled using the <em>value</em> for <em>ReplicaNodeSelector</em> . In following sample storage class yaml, <code>node: openebs</code> is the node label.</p>
<pre><code class="hljs"><span class="hljs-attribute">apiVersion</span>: storage.k8s.io/v1
<span class="hljs-attribute">kind</span>: StorageClass
<span class="hljs-attribute">metadata</span>:
  <span class="hljs-attribute">annotations</span>:
    cas.openebs.io/<span class="hljs-attribute">config</span>: |
      - <span class="hljs-attribute">name</span>: ReplicaNodeSelector
        <span class="hljs-attribute">value</span>: |-
            <span class="hljs-attribute">node</span>: openebs
    openebs.io/<span class="hljs-attribute">cas-type</span>: jiva
</code></pre>
<p><h3><a class="anchor" aria-hidden="true" id="TargetTolerations"></a>TargetTolerations Policy </h3></p>
<p>You can specify the <em>TargetTolerations</em> to specify the tolerations for Jiva target.</p>
<pre><code class="hljs">- name: TargetTolerations
<span class="hljs-symbol">  value:</span> |-
<span class="hljs-symbol">     t1:</span>
<span class="hljs-symbol">       key:</span> <span class="hljs-string">"key1"</span>
<span class="hljs-symbol">       operator:</span> <span class="hljs-string">"Equal"</span>
<span class="hljs-symbol">       value:</span> <span class="hljs-string">"value1"</span>
<span class="hljs-symbol">       effect:</span> <span class="hljs-string">"NoSchedule"</span>
<span class="hljs-symbol">     t2:</span>
<span class="hljs-symbol">       key:</span> <span class="hljs-string">"key1"</span>
<span class="hljs-symbol">       operator:</span> <span class="hljs-string">"Equal"</span>
<span class="hljs-symbol">       value:</span> <span class="hljs-string">"value1"</span>
<span class="hljs-symbol">       effect:</span> <span class="hljs-string">"NoExecute"</span>
</code></pre>
<p><h3><a class="anchor" aria-hidden="true" id="ReplicaTolerations"></a>ReplicaTolerations Policy </h3></p>
<p>You can specify the <em>ReplicaTolerations</em> to specify the tolerations for Replica.</p>
<pre><code class="hljs">- name: ReplicaTolerations
<span class="hljs-symbol">  value:</span> |-
<span class="hljs-symbol">     t1:</span>
<span class="hljs-symbol">       key:</span> <span class="hljs-string">"key1"</span>
<span class="hljs-symbol">       operator:</span> <span class="hljs-string">"Equal"</span>
<span class="hljs-symbol">       value:</span> <span class="hljs-string">"value1"</span>
<span class="hljs-symbol">       effect:</span> <span class="hljs-string">"NoSchedule"</span>
<span class="hljs-symbol">     t2:</span>
<span class="hljs-symbol">       key:</span> <span class="hljs-string">"key1"</span>
<span class="hljs-symbol">       operator:</span> <span class="hljs-string">"Equal"</span>
<span class="hljs-symbol">       value:</span> <span class="hljs-string">"value1"</span>
<span class="hljs-symbol">       effect:</span> <span class="hljs-string">"NoExecute"</span>
</code></pre>
<p><h3><a class="anchor" aria-hidden="true" id="TargetResourceRequests"></a>TargetResourceRequests Policy </h3></p>
<p>You can specify the <em>TargetResourceRequests</em> to specify resource requests that need to be available before scheduling the containers.</p>
<pre><code class="hljs"><span class="hljs-attribute">apiVersion</span>: storage.k8s.io/v1
<span class="hljs-attribute">kind</span>: StorageClass
<span class="hljs-attribute">metadata</span>:
  <span class="hljs-attribute">annotations</span>:
    cas.openebs.io/<span class="hljs-attribute">config</span>: |
      - <span class="hljs-attribute">name</span>: TargetResourceRequests
        <span class="hljs-attribute">value</span>: <span class="hljs-string">"none"</span>
    openebs.io/<span class="hljs-attribute">cas-type</span>: jiva
</code></pre>
<p><h3><a class="anchor" aria-hidden="true" id="Target-ResourceLimits-Policy"></a>Target ResourceLimits Policy</h3></p>
<p>You can specify the <em>TargetResourceLimits</em> to restrict the memory and cpu usage of Jiva target pod within the given limit using the <em>value</em> for <em>TargetResourceLimits</em> .</p>
<pre><code class="hljs"><span class="hljs-attribute">apiVersion</span>: storage.k8s.io/v1
<span class="hljs-attribute">kind</span>: StorageClass
<span class="hljs-attribute">metadata</span>:
  <span class="hljs-attribute">annotations</span>:
    cas.openebs.io/<span class="hljs-attribute">config</span>: |
      - <span class="hljs-attribute">name</span>: TargetResourceLimits
        <span class="hljs-attribute">value</span>: |-
            <span class="hljs-attribute">memory</span>: <span class="hljs-number">1</span>Gi
            <span class="hljs-attribute">cpu</span>: <span class="hljs-number">100</span>m
    openebs.io/<span class="hljs-attribute">cas-type</span>: jiva
</code></pre>
<p><h3><a class="anchor" aria-hidden="true" id="AuxResourceLimits-Policy"></a>AuxResourceLimits Policy</h3></p>
<p>You can specify the <em>AuxResourceLimits</em> which allow you to set limits on side cars.</p>
<pre><code class="hljs"><span class="hljs-attribute">apiVersion</span>: storage.k8s.io/v1
<span class="hljs-attribute">kind</span>: StorageClass
<span class="hljs-attribute">metadata</span>:
  <span class="hljs-attribute">annotations</span>:
    cas.openebs.io/<span class="hljs-attribute">config</span>: |
      - <span class="hljs-attribute">name</span>: AuxResourceLimits
        <span class="hljs-attribute">value</span>: |-
            <span class="hljs-attribute">memory</span>: <span class="hljs-number">0.5</span>Gi
            <span class="hljs-attribute">cpu</span>: <span class="hljs-number">50</span>m
    openebs.io/<span class="hljs-attribute">cas-type</span>: jiva
</code></pre>
<p><h3><a class="anchor" aria-hidden="true" id="AuxResourceRequests-Policy"></a>AuxResourceRequests Policy</h3></p>
<p>This feature is useful in cases where user has to specify minimum requests like ephemeral storage etc. to avoid erroneous eviction by K8s. <code>AuxResourceRequests</code> allow you to set requests on side cars. Requests have to be specified in the format expected by Kubernetes.</p>
<pre><code class="hljs"><span class="hljs-attribute">apiVersion</span>: storage.k8s.io/v1
<span class="hljs-attribute">kind</span>: StorageClass
<span class="hljs-attribute">metadata</span>:
  <span class="hljs-attribute">annotations</span>:
    cas.openebs.io/<span class="hljs-attribute">config</span>: |
      - <span class="hljs-attribute">name</span>: AuxResourceRequests
        <span class="hljs-attribute">value</span>: <span class="hljs-string">"none"</span>
    openebs.io/<span class="hljs-attribute">cas-type</span>: jiva
</code></pre>
<p><h3><a class="anchor" aria-hidden="true" id="ReplicaResourceLimits-Policy"></a>ReplicaResourceLimits Policy</h3></p>
<p>You can specify the <em>ReplicaResourceLimits</em> to restrict the memory usage of replica pod within the given limit using the <em>value</em> for <em>ReplicaResourceLimits</em>.</p>
<pre><code class="hljs"><span class="hljs-attribute">apiVersion</span>: storage.k8s.io/v1
<span class="hljs-attribute">kind</span>: StorageClass
<span class="hljs-attribute">metadata</span>:
  <span class="hljs-attribute">annotations</span>:
    cas.openebs.io/<span class="hljs-attribute">config</span>: |
      - <span class="hljs-attribute">name</span>: ReplicaResourceLimits
        <span class="hljs-attribute">value</span>: |-
            <span class="hljs-attribute">memory</span>: <span class="hljs-number">2</span>Gi
    openebs.io/<span class="hljs-attribute">cas-type</span>: jiva
</code></pre>
<p><h3><a class="anchor" aria-hidden="true" id="Target-Affinity-Policy"></a>Target Affinity Policy</h3></p>
<p>The StatefulSet workloads access the OpenEBS storage volume by connecting to the Volume Target Pod. This policy can be used to co-locate volume target pod on the same node as workload.</p>
<ul>
<li><p>This feature makes use of the Kubernetes Pod Affinity feature that is dependent on the Pod labels. User will need to add the following label to both Application and PVC.</p>
<pre><code class="hljs">labels:
  openebs.io/target-affinity: &lt;application-unique-<span class="hljs-keyword">label</span><span class="bash">&gt;
</span></code></pre></li>
<li><p>You can specify the Target Affinity in both application and OpenEBS PVC using the following way</p>
<p>For Application Pod, it will be similar to the following</p>
<pre><code class="hljs"><span class="hljs-attribute">apiVersion</span>: v1
<span class="hljs-attribute">kind</span>: Pod
<span class="hljs-attribute">metadata</span>:
  <span class="hljs-attribute">name</span>: fio-jiva
  <span class="hljs-attribute">labels</span>:
    <span class="hljs-attribute">name</span>: fio-jiva
    openebs.io/<span class="hljs-attribute">target-affinity</span>: fio-jiva
</code></pre>
<p>For OpenEBS PVC, it will be similar to the following.</p>
<pre><code class="hljs"><span class="hljs-attribute">kind</span>: PersistentVolumeClaim
<span class="hljs-attribute">apiVersion</span>: v1
<span class="hljs-attribute">metadata</span>:
  <span class="hljs-attribute">name</span>: fio-jiva-claim
  <span class="hljs-attribute">labels</span>:
    openebs.io/<span class="hljs-attribute">target-affinity</span>: fio-jiva
</code></pre></li>
</ul>
<p><strong>Note</strong>: <em>This feature works only for cases where there is a 1-1 mapping between a application and PVC. It's not recommended for STS where PVC is specified as a template.</em></p>
<p><br></p>
<h2><a class="anchor" aria-hidden="true" id="see-also"></a><a href="#see-also" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>See Also:</h2>
<h3><a class="anchor" aria-hidden="true" id="backup-and-restore-docs-next-backuphtml"></a><a href="#backup-and-restore-docs-next-backuphtml" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><a href="/docs/next/backup.html">Backup and Restore</a></h3>
<p><br></p>
<hr>
<br>
<!-- Hotjar Tracking Code for https://docs.openebs.io -->
<script>
   (function(h,o,t,j,a,r){
       h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
       h._hjSettings={hjid:785693,hjsv:6};
       a=o.getElementsByTagName('head')[0];
       r=o.createElement('script');r.async=1;
       r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
       a.appendChild(r);
   })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-92076314-12"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
<p>gtag('config', 'UA-92076314-12');</p>
</script>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="operations.html">← Day2 operations in OpenEBS</a><a class="docs-next button" href="mayactl.html">Mayactl →</a></div></div></div><nav class="onPageNav"><div id="global-on-page-heading"><h4 style="font-weight:400;">On this page:</h4><ul class="toc-headings"><li><a href="#simple-provisioning-of-jiva">Simple provisioning of jiva</a></li><li><a href="#provisioning-with-local-or-cloud-disks">Provisioning with local or cloud disks</a><ul class="toc-headings"><li><a href="#prepare-disks-and-mount-them">Prepare disks and mount them</a></li><li><a href="#create-a-jiva-pool">Create a Jiva pool</a></li><li><a href="#create-a-storageclass">Create a StorageClass</a></li><li><a href="#provision-jiva-volumes">Provision Jiva Volumes</a></li><li><a href="#jiva-storage-policies">Jiva Storage Policies</a></li></ul></li><li><a href="#see-also">See Also:</a><ul class="toc-headings"><li><a href="#backup-and-restore-docs-next-backuphtml">Backup and Restore</a></li></ul></li></ul></div></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><div><br/><div><a href="https://openebs.io" target="_blank"><img src="/docs/assets/openebs-logo.svg" alt="" width="130" height="110"/></a></div><div><a href="https://slack.openebs.io">Get in touch with OpenEBS community via Slack</a></div></div><div><br/><div><a href="https://mayadata.io" target="_blank"><img src="https://openebs.io/assets/images/mayadata.svg" alt="mayadata.io" width="130" height="110"/></a></div><div><a href="https://app.mayaonline.io">Get OpenEBS support through MayaOnline</a></div></div></section><section class="copyright"></section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
              var search = docsearch({
                
                apiKey: 'dc657dfe30f42f228671f557f49ced7a',
                indexName: 'openebs',
                inputSelector: '#search_input_react'
              });
            </script><script>(function(){ window.ldfdr = window.ldfdr || {}; (function(d, s, ss, fs){ fs = d.getElementsByTagName(s)[0]; function ce(src){ var cs = d.createElement(s); cs.async=1; cs.src = src; setTimeout(function(){fs.parentNode.insertBefore(cs,fs)}, 1); } ce(ss); })(document, 'script', 'https://lftracker.leadfeeder.com/lftracker_v1_bMwm7E2pzw4gOZyA.js'); })();</script></body></html>