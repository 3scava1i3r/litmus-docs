<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Configuring Storage Classes · </title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta property="og:title" content="Configuring Storage Classes · "/><meta property="og:type" content="website"/><meta property="og:url" content="https://docs.openebs.io/index.html"/><meta property="og:description" content="------"/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/img/favicon.ico"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="stylesheet" href="/css/code-blocks-buttons.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/js/code-blocks-buttons.js"></script><link rel="stylesheet" href="/css/main.css"/></head><body class="sideNavVisible doc separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img id="logo" src="/img/OpenEBS-logo.svg" alt=""/><img class="logo-text" src="/img/openebs-docs-logo.svg" alt=""/><h2 class="headerTitle"></h2></a><div class="dropdown"><span class="ver-link">0.8.1</span><span class="ver-link-span"><i class="arrow down"></i></span><div class="dropdown-menu" id="versions-list" aria-labelledby="dropdownMenuButton"><a class="dropdown-item" id="0" href="https://docs.openebs.io">0.8.1</a><a class="dropdown-item" id="1" href="https://v08-docs.openebs.io">0.8.0</a><a class="dropdown-item" id="2" href="https://v07-docs.openebs.io">0.7.0</a><a class="dropdown-item" id="3" href="https://v06-docs.openebs.io">0.6.0</a><a class="dropdown-item" id="4" href="https://v05-docs.openebs.io">0.5.0</a></div></div><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><a href="https://app.mayaonline.io" target="_blank" rel="noreferrer noopener"><div class="float rotate"><img src="../../../../../../docs/assets/mo-logo.png" alt="MayaOnline" height="45px" width="45px" title="Connect to MayaOnline"/></div></a><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>User Guides</span></h2></div><div class="navGroups"><div class="navGroup navGroupActive"><h3 id="Introduction" class="languages-menu">Introduction</h3><div class="hide" id="Introduction dropdown-content-div"><ul id="languages-dropdown-items"><li class="navListItem"><a class="navItem" href="/docs/next/overview.html">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/next/features.html">Features and Benefits</a></li><li class="navListItem"><a class="navItem" href="/docs/next/usecases.html">Use cases</a></li><li class="navListItem"><a class="navItem" href="/docs/next/releases.html">Releases</a></li><li class="navListItem"><a class="navItem" href="/docs/next/support.html">Support</a></li><li class="navListItem"><a class="navItem" href="/docs/next/mayaonline.html">MayaOnline</a></li></ul></div></div><div class="navGroup navGroupActive"><h3 id="Concepts" class="languages-menu">Concepts</h3><div class="hide" id="Concepts dropdown-content-div"><ul id="languages-dropdown-items"><li class="navListItem"><a class="navItem" href="/docs/next/cas.html">Container Attached Storage</a></li><li class="navListItem"><a class="navItem" href="/docs/next/architecture.html">OpenEBS Architecture</a></li><li class="navListItem"><a class="navItem" href="/docs/next/casengines.html">CAS Engines (cStor &amp; Jiva)</a></li><li class="navListItem"><a class="navItem" href="/docs/next/cstor.html">cStor</a></li><li class="navListItem"><a class="navItem" href="/docs/next/jiva.html">Jiva</a></li></ul></div></div><div class="navGroup navGroupActive"><h3 id="User Guides" class="languages-menu">User Guides</h3><div class="hide" id="User Guides dropdown-content-div"><ul id="languages-dropdown-items"><li class="navListItem"><a class="navItem" href="/docs/next/quickstart.html">Quickstart</a></li><li class="navListItem"><a class="navItem" href="/docs/next/prerequisites.html">Prerequisites</a></li><li class="navListItem"><a class="navItem" href="/docs/next/installation.html">Installation</a></li><li class="navListItem"><a class="navItem" href="/docs/next/configurepools.html">Configure StoragePools</a></li><li class="navListItem navListItemActive"><a class="navItem navItemActive" href="/docs/next/configuresc.html">Configuring StorageClasses</a></li><li class="navListItem"><a class="navItem" href="/docs/next/provisionvols.html">Provisioning Volumes</a></li><li class="navListItem"><a class="navItem" href="/docs/next/operations.html">Day 2 Operations</a></li><li class="navListItem"><a class="navItem" href="/docs/next/jivaguide.html">Jiva user guide</a></li><li class="navListItem"><a class="navItem" href="/docs/next/mayactl.html">Mayactl</a></li><li class="navListItem"><a class="navItem" href="/docs/next/backup.html">Backup and Restore</a></li><li class="navListItem"><a class="navItem" href="/docs/next/upgrade.html">Upgrade</a></li><li class="navListItem"><a class="navItem" href="/docs/next/uninstall.html">Uninstall</a></li></ul></div></div><div class="navGroup navGroupActive"><h3 id="Stateful Applications" class="languages-menu">Stateful Applications</h3><div class="hide" id="Stateful Applications dropdown-content-div"><ul id="languages-dropdown-items"><li class="navListItem"><a class="navItem" href="/docs/next/mysql.html">RDS like MySQL</a></li><li class="navListItem"><a class="navItem" href="/docs/next/prometheus.html">Prometheus</a></li><li class="navListItem"><a class="navItem" href="/docs/next/minio.html">Minio</a></li><li class="navListItem"><a class="navItem" href="/docs/next/gitlab.html">GitLab</a></li><li class="navListItem"><a class="navItem" href="/docs/next/percona.html">Percona</a></li><li class="navListItem"><a class="navItem" href="/docs/next/elasticsearch.html">ElasticSearch</a></li><li class="navListItem"><a class="navItem" href="/docs/next/cassandra.html">Cassandra</a></li><li class="navListItem"><a class="navItem" href="/docs/next/nuodb.html">NuoDB</a></li><li class="navListItem"><a class="navItem" href="/docs/next/postgres.html">PostgreSQL</a></li><li class="navListItem"><a class="navItem" href="/docs/next/redis.html">Redis</a></li><li class="navListItem"><a class="navItem" href="/docs/next/mongo.html">MongoDB</a></li><li class="navListItem"><a class="navItem" href="/docs/next/rwm.html">Read-Write-Many (RWM)</a></li></ul></div></div><div class="navGroup navGroupActive"><h3 id="Advanced Topics" class="languages-menu">Advanced Topics</h3><div class="hide" id="Advanced Topics dropdown-content-div"><ul id="languages-dropdown-items"><li class="navListItem"><a class="navItem" href="/docs/next/performance.html">Performance testing</a></li><li class="navListItem"><a class="navItem" href="/docs/next/faq.html">FAQs</a></li><li class="navListItem"><a class="navItem" href="/docs/next/k8supgrades.html">Kubernetes upgrades</a></li><li class="navListItem"><a class="navItem" href="/docs/next/troubleshooting.html">Troubleshooting</a></li></ul></div></div></div></section></div><script>
          var toggler = document.getElementById('navToggler');
          var nav = document.getElementById('docsNav');
          toggler.onclick = function() {
            nav.classList.toggle('docsSliderActive');
          };
        </script><script>
            var navGroupElem = document.getElementsByClassName("hide");
            for(var k=0; k<navGroupElem.length; k++){
              if (navGroupElem[k].innerHTML.indexOf("navItem navItemActive") != -1) {
                document.getElementById(navGroupElem[k].id).className = "visible";
              }
            }
            var elem = document.getElementsByClassName("languages-menu");
            for (var i=0; i < elem.length; i++){
              document.getElementById(String(elem[i].id)).addEventListener("click", function() {
                sessionStorage.setItem("name", document.getElementById(this.id+" dropdown-content-div").className);
                sessionStorage.setItem("Id", document.getElementById(this.id).id);
                if ( document.getElementById(this.id+" dropdown-content-div").className == "hide") {
                  document.getElementById(this.id+" dropdown-content-div").className = "visible";
                }
                else {
                  document.getElementById(this.id+" dropdown-content-div").className = "hide";
                }
            })};</script><script>
          var SelectedItemClassName = sessionStorage.getItem("name");
          var SelectedItemId = sessionStorage.getItem("Id");
          if (SelectedItemClassName == "hide"){
            document.getElementById( SelectedItemId +" dropdown-content-div").className = "visible";
          }
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/openebs/openebs-docs/edit/staging/docs/configuresc.md" target="_blank" rel="noreferrer noopener">Edit</a><a class="edit-page-link button" href="https://github.com/openebs/openebs/issues/new/" target="_blank" rel="noreferrer noopener">Create An Issue</a><h1>Configuring Storage Classes</h1></header><article><div><span><hr>
<p><br></p>
<p><img src="/docs/assets/svg/3-config-sequence.svg" alt="OpenEBS configuration flow" style="width:100%"></p>
<p><br></p>
<p><font size="6">Summary:</font></p>
<p><a href="#sparse-class">Using openebs-cstor-sparse StorageClass</a></p>
<p><a href="#creating-a-new-class">Creating a new StorageClass for cStor</a></p>
<p><a href="#cstor-storage-policies">cStor Storage Policies</a></p>
<p><em>Note: This page describes how to create, use and maintain StorageClasses that use cStorPools. For details about StorageClasses that Jiva pools, see <a href="/docs/next/jivaguide.html">Jiva user guide</a></em></p>
<p><br></p>
<hr>
<p><br></p>
<h2><a class="anchor" aria-hidden="true" id="using-sparse-storageclass"></a><a href="#using-sparse-storageclass" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Using sparse StorageClass</h2>
<p><br></p>
<p>During the installation, OpenEBS creates a StorageClass called <code>openebs-cstor-sparse</code> . You can use this StorageClass for creating a PVC (  <code>kind: PersistentVolumeClaim</code> for applications of <code>kind: Deployment</code>) or for creating a VolumeClaimTemplate (<code>volumeClaimTemplates:</code> for applications of <code>kind: StatefulSet</code>)</p>
<p>Note that this StorageClass has cStor volumes <code>replicaCount</code> set as <code>3</code>. Sometimes it may not be necessary to have three storage replicas for each statefulset application replica. In such cases, you can create a new StorageClass that uses the existing sparse pool <code>cstor-sparse-pool</code> but with cStor volume's replicaCount=1. This can be done by creating a new StorageClass YAML with mentioning single replica. You can create a new StorageClass YAML called  <strong>openebs-sparse-sc-statefulset.yaml</strong> and add content to it from below.</p>
<pre><code class="hljs"><span class="hljs-attribute">apiVersion</span>: storage.k8s.io/v1
<span class="hljs-attribute">kind</span>: StorageClass
<span class="hljs-attribute">metadata</span>:
  <span class="hljs-attribute">name</span>: openebs-sparse-sc-statefulset
  <span class="hljs-attribute">annotations</span>:
    openebs.io/<span class="hljs-attribute">cas-type</span>: cstor
    cas.openebs.io/<span class="hljs-attribute">config</span>: |
      - <span class="hljs-attribute">name</span>: StoragePoolClaim
        <span class="hljs-attribute">value</span>: <span class="hljs-string">"cstor-sparse-pool"</span>
      - <span class="hljs-attribute">name</span>: ReplicaCount
        <span class="hljs-attribute">value</span>: <span class="hljs-string">"1"</span>
<span class="hljs-attribute">provisioner</span>: openebs.io/provisioner-iscsi
<span class="hljs-attribute">reclaimPolicy</span>: Delete
</code></pre>
<p>The above command creates storage class called <code>openebs-sparse-sc-statefulset</code> which you can use under volumeClaimTemplates.</p>
<p><br></p>
<hr>
<h2><a class="anchor" aria-hidden="true" id="creating-a-new-storageclass"></a><a href="#creating-a-new-storageclass" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Creating a new StorageClass</h2>
<p><br></p>
<p>StorageClass definition is an important task in the planning and execution of OpenEBS storage. As detailed in the CAS page, the real power of CAS architecture is to give an independent or a dedicated storage engine like cStor for each workload, so that granular policies can be applied to that storage engine to tune the behaviour or performance as per the workload's need. In OpenEBS policies to the storage engine (in this case it is cStor) through the <code>annotations</code> specified in the <code>StorageClass</code> interface.</p>
<p><font size="5">Steps to create a cStor StorageClass</font></p>
<p><strong>Step1:</strong> Decide the cStorPool</p>
<p><strong>Step2:</strong> Which application uses it? Decide the replicaCount based on it</p>
<p><strong>Step3:</strong> Are there any other storage policies to be applied to the StorageClass? Refer to the <a href="#cstor-storage-policies">storage policies section</a> for more details on the storage policies applicable for cStor.</p>
<p><strong>Step4:</strong> Create a YAML spec file &lt;storage-class-name.yaml&gt; from the master template below, update the pool, replica count and other policies and create the class using <code>kubectl apply -f &lt;storage-class-name.yaml&gt;</code> command.</p>
<p><strong>Step5:</strong> Verify the newly created StorageClass using <code>kubectl describe sc &lt;storage-class-name&gt;</code></p>
<p><br></p>
<hr>
<p><br></p>
<h2><a class="anchor" aria-hidden="true" id="cstor-storage-policies"></a><a href="#cstor-storage-policies" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>cStor storage policies</h2>
<p>Below table lists the storage policies supported by cStor. These policies should be built into StorageClass and apply them through PersistentVolumeClaim or VolumeClaimTemplates interface</p>
<table>
<thead>
<tr><th>cStor Storage Policy</th><th>Mandatory</th><th>Default</th><th>Purpose</th></tr>
</thead>
<tbody>
<tr><td><a href="#Replica-Count-Policy">ReplicaCount</a></td><td>No</td><td>3</td><td>Defines the number of cStor volume replicas</td></tr>
<tr><td><a href="#Volume-Controller-Image-Policy">VolumeControllerImage</a></td><td></td><td>quay.io/openebs/cstor-volume-mgmt:0.8.1</td><td>Dedicated side car for command management like taking snapshots etc. Can be used to apply a specific issue or feature for the workload</td></tr>
<tr><td><a href="#Volume-Target-Image-Policy">VolumeTargetImage</a></td><td></td><td>value:quay.io/openebs/cstor-istgt:0.8.1</td><td>iSCSI protocol stack dedicated to the workload. Can be used to apply a specific issue or feature for the workload</td></tr>
<tr><td><a href="#Storage-Pool-Claim-Policy">StoragePoolClaim</a></td><td>Yes</td><td>N/A (a valid pool must be provided)</td><td>The cStorPool on which the volume replicas should be provisioned</td></tr>
<tr><td><a href="#Volume-Monitor-Policy">VolumeMonitor</a></td><td></td><td>ON</td><td>When ON, a volume exporter sidecar is launched to export Prometheus metrics.</td></tr>
<tr><td><a href="#Volume-Monitoring-Image-Policy">VolumeMonitorImage</a></td><td></td><td>quay.io/openebs/m-exporter:0.8.1</td><td>Used when VolumeMonitor is ON. A dedicated metrics exporter to the workload. Can be used to apply a specific issue or feature for the workload</td></tr>
<tr><td><a href="#Volume-File-System-Type-Policy">FSType</a></td><td></td><td>ext4</td><td>Specifies the filesystem that the volume should be formatted with. Other values are <code>xfs</code></td></tr>
<tr><td><a href="#Target-NodeSelector-Policy">TargetNodeSelector</a></td><td></td><td>Decided by Kubernetes scheduler</td><td>Specify the label in <code>key: value</code> format to notify Kubernetes scheduler to schedule cStor target pod on the nodes that match label</td></tr>
<tr><td><a href="#Target-ResourceLimits-Policy">TargetResourceLimits</a></td><td></td><td>Decided by Kubernetes scheduler</td><td>CPU and Memory limits to cStor target pod</td></tr>
<tr><td><a href="#TargetResourceRequests">TargetResourceRequests</a></td><td></td><td>Decided by Kubernetes scheduler</td><td>Configuring resource requests that need to be available before scheduling the containers.</td></tr>
<tr><td><a href="#TargetTolerations">TargetTolerations</a></td><td></td><td>Decided by Kubernetes scheduler</td><td>Configuring the tolerations for target.</td></tr>
<tr><td><a href="#AuxResourceLimits-Policy">AuxResourceLimits</a></td><td></td><td>Decided by Kubernetes scheduler</td><td>Configuring resource limits on the pool and volume pod side-cars.</td></tr>
<tr><td><a href="#AuxResourceRequests-Policy">AuxResourceRequests</a></td><td></td><td>Decided by Kubernetes scheduler</td><td>Configure minimum requests like ephemeral storage etc. to avoid erroneous eviction by K8s.</td></tr>
<tr><td><a href="#Target-Affinity-Policy">Target Affinity</a></td><td></td><td>Decided by Kubernetes scheduler</td><td>The policy specifies the label KV pair to be used both on the cStor target and on the application being used so that application pod and cStor target pod are scheduled on the same node.</td></tr>
<tr><td><a href="#Target-Namespace">Target Namespace</a></td><td></td><td>openebs</td><td>When service account name is specified, the cStor target pod is scheduled in the application's namespace.</td></tr>
</tbody>
</table>
<p><br></p>
<p><br></p>
<p><h3><a class="anchor" aria-hidden="true" id="Replica-Count-Policy"></a>Replica Count Policy</h3></p>
<p>You can specify the cStor Pool replica count using the <em>value</em> for <em>ReplicaCount</em> property. In the following example, the ReplicaCount is specified as 3. Hence, three replicas for storage pool will be created.</p>
<pre><code class="hljs"><span class="hljs-attribute">apiVersion</span>: storage.k8s.io/v1
<span class="hljs-attribute">kind</span>: StorageClass
<span class="hljs-attribute">metadata</span>:
  <span class="hljs-attribute">annotations</span>:
    cas.openebs.io/<span class="hljs-attribute">config</span>: |
      - <span class="hljs-attribute">name</span>: ReplicaCount
        <span class="hljs-attribute">value</span>: <span class="hljs-string">"3"</span>
    openebs.io/<span class="hljs-attribute">cas-type</span>: cstor
</code></pre>
<p><h3><a class="anchor" aria-hidden="true" id="Volume-Controller-Image-Policy"></a>Volume Controller Image Policy</h3></p>
<p>You can specify the cStor Volume Controller Image using the <em>value</em> for <em>VolumeControllerImage</em> property. This will help you choose the volume management image.</p>
<pre><code class="hljs"><span class="hljs-attribute">apiVersion</span>: storage.k8s.io/v1
<span class="hljs-attribute">kind</span>: StorageClass
<span class="hljs-attribute">metadata</span>:
  <span class="hljs-attribute">annotations</span>:
    cas.openebs.io/<span class="hljs-attribute">config</span>: |
      - <span class="hljs-attribute">name</span>: VolumeControllerImage
        <span class="hljs-attribute">value</span>: quay.io/openebs/<span class="hljs-attribute">cstor-volume-mgmt</span>:<span class="hljs-number">0.8</span>.<span class="hljs-number">1</span>
    openebs.io/<span class="hljs-attribute">cas-type</span>: cstor
</code></pre>
<p><h3><a class="anchor" aria-hidden="true" id="Volume-Target-Image-Policy"></a>Volume Target Image Policy</h3></p>
<p>You can specify the cStor Target Image using the <em>value</em> for <em>VolumeTargetImage</em> property. This will help you choose the cStor istgt target image.</p>
<pre><code class="hljs"><span class="hljs-attribute">apiVersion</span>: storage.k8s.io/v1
<span class="hljs-attribute">kind</span>: StorageClass
<span class="hljs-attribute">metadata</span>:
  <span class="hljs-attribute">annotations</span>:
    cas.openebs.io/<span class="hljs-attribute">config</span>: |
      - <span class="hljs-attribute">name</span>: VolumeTargetImage
        <span class="hljs-attribute">value</span>:quay.io/openebs/<span class="hljs-attribute">cstor-istgt</span>:<span class="hljs-number">0.8</span>.<span class="hljs-number">1</span>
    openebs.io/<span class="hljs-attribute">cas-type</span>: cstor
</code></pre>
<p><h3><a class="anchor" aria-hidden="true" id="Storage-Pool-Claim-Policy"></a>Storage Pool Claim Policy</h3></p>
<p>You can specify the cStor Pool Claim name using the <em>value</em> for <em>StoragePoolClaim</em> property. This will help you choose cStor storage pool name where OpenEBS volume will be created. Following is the default StorageClass template where cStor volume will be created on default cStor Sparse Pool.</p>
<pre><code class="hljs"><span class="hljs-attribute">apiVersion</span>: storage.k8s.io/v1
<span class="hljs-attribute">kind</span>: StorageClass
<span class="hljs-attribute">metadata</span>:
  <span class="hljs-attribute">annotations</span>:
    cas.openebs.io/<span class="hljs-attribute">config</span>: |
      - <span class="hljs-attribute">name</span>: StoragePoolClaim
        <span class="hljs-attribute">value</span>: <span class="hljs-string">"cstor-sparse-pool"</span>
    openebs.io/<span class="hljs-attribute">cas-type</span>: cstor
</code></pre>
<p><h3><a class="anchor" aria-hidden="true" id="Volume-Monitor-Policy"></a>Volume Monitor Policy</h3></p>
<p>You can specify the cStor volume monitor feature which can be set using <em>value</em> for the <em>VolumeMonitor</em> property.  By default, volume monitor is enabled.</p>
<pre><code class="hljs"><span class="hljs-attribute">apiVersion</span>: storage.k8s.io/v1
<span class="hljs-attribute">kind</span>: StorageClass
<span class="hljs-attribute">metadata</span>:
  <span class="hljs-attribute">annotations</span>:
    cas.openebs.io/<span class="hljs-attribute">config</span>: |
      - <span class="hljs-attribute">enabled</span>: <span class="hljs-string">"true"</span>
        <span class="hljs-attribute">name</span>: VolumeMonitor
    openebs.io/<span class="hljs-attribute">cas-type</span>: cstor
</code></pre>
<p><h3><a class="anchor" aria-hidden="true" id="Volume-Monitoring-Image-Policy"></a>Volume Monitoring Image Policy</h3></p>
<p>You can specify the monitoring image policy for a particular volume using <em>value</em> for <em>VolumeMonitorImage</em> property. The following sample storage class uses the Volume Monitor Image policy.</p>
<pre><code class="hljs"><span class="hljs-attribute">apiVersion</span>: storage.k8s.io/v1
<span class="hljs-attribute">kind</span>: StorageClass
<span class="hljs-attribute">metadata</span>:
  <span class="hljs-attribute">annotations</span>:
    cas.openebs.io/<span class="hljs-attribute">config</span>: |
      - <span class="hljs-attribute">name</span>: VolumeMonitorImage
        <span class="hljs-attribute">value</span>: quay.io/openebs/<span class="hljs-attribute">m-exporter</span>:<span class="hljs-number">0.8</span>.<span class="hljs-number">1</span>
    openebs.io/<span class="hljs-attribute">cas-type</span>: cstor
</code></pre>
<p><h3><a class="anchor" aria-hidden="true" id="Volume-File-System-Type-Policy"></a>Volume File System Type Policy</h3></p>
<p>You can specify the file system type for the cStor volume where application will consume the storage using <em>value</em> for <em>FSType</em>. The following is the sample storage class. Currently OpenEBS support ext4 as the default file system and it also supports XFS as filesystem.</p>
<pre><code class="hljs"><span class="hljs-attribute">apiVersion</span>: storage.k8s.io/v1
<span class="hljs-attribute">kind</span>: StorageClass
<span class="hljs-attribute">metadata</span>:
  <span class="hljs-attribute">annotations</span>:
    cas.openebs.io/<span class="hljs-attribute">config</span>: |
      - <span class="hljs-attribute">name</span>: FSType
        <span class="hljs-attribute">value</span>: ext4
    openebs.io/<span class="hljs-attribute">cas-type</span>: cstor
</code></pre>
<p><h3><a class="anchor" aria-hidden="true" id="Target-NodeSelector-Policy"></a>Target NodeSelector Policy</h3></p>
<p>You can specify the <em>TargetNodeSelector</em> where Target pod has to be scheduled using the <em>value</em> for <em>TargetNodeSelector</em>. In following example, <code>node: apnode</code>is the node label.</p>
<pre><code class="hljs"><span class="hljs-attribute">apiVersion</span>: storage.k8s.io/v1
<span class="hljs-attribute">kind</span>: StorageClass
<span class="hljs-attribute">metadata</span>:
  <span class="hljs-attribute">annotations</span>:
    cas.openebs.io/<span class="hljs-attribute">config</span>: |
      - <span class="hljs-attribute">name</span>: TargetNodeSelector
        <span class="hljs-attribute">value</span>: |-
            <span class="hljs-attribute">node</span>: appnode
    openebs.io/<span class="hljs-attribute">cas-type</span>: cstor
</code></pre>
<p><h3><a class="anchor" aria-hidden="true" id="Target-ResourceLimits-Policy"></a>Target ResourceLimits Policy</h3></p>
<p>You can specify the <em>TargetResourceLimits</em> to restrict the memory and cpu usage of target pod within the given limit  using the <em>value</em> for <em>TargetResourceLimits</em> .</p>
<pre><code class="hljs"><span class="hljs-attribute">apiVersion</span>: storage.k8s.io/v1
<span class="hljs-attribute">kind</span>: StorageClass
<span class="hljs-attribute">metadata</span>:
  <span class="hljs-attribute">annotations</span>:
    cas.openebs.io/<span class="hljs-attribute">config</span>: |
      - <span class="hljs-attribute">name</span>: TargetResourceLimits
        <span class="hljs-attribute">value</span>: |-
            <span class="hljs-attribute">memory</span>: <span class="hljs-number">1</span>Gi
            <span class="hljs-attribute">cpu</span>: <span class="hljs-number">100</span>m
    openebs.io/<span class="hljs-attribute">cas-type</span>: cstor
</code></pre>
<p><h3><a class="anchor" aria-hidden="true" id="TargetResourceRequests"></a>TargetResourceRequests Policy </h3></p>
<p>You can specify the <em>TargetResourceRequests</em> to specify resource requests that need to be available before scheduling the containers.</p>
<pre><code class="hljs"><span class="hljs-attribute">apiVersion</span>: storage.k8s.io/v1
<span class="hljs-attribute">kind</span>: StorageClass
<span class="hljs-attribute">metadata</span>:
  <span class="hljs-attribute">annotations</span>:
    cas.openebs.io/<span class="hljs-attribute">config</span>: |
      - <span class="hljs-attribute">name</span>: TargetResourceRequests
        <span class="hljs-attribute">value</span>: <span class="hljs-string">"none"</span>
    openebs.io/<span class="hljs-attribute">cas-type</span>: cstor
</code></pre>
<p><h3><a class="anchor" aria-hidden="true" id="TargetTolerations"></a>TargetTolerations Policy </h3></p>
<p>You can specify the <em>TargetTolerations</em> to specify the tolerations for target.</p>
<pre><code class="hljs">- name: TargetTolerations
<span class="hljs-symbol">  value:</span> |-
<span class="hljs-symbol">     t1:</span>
<span class="hljs-symbol">       key:</span> <span class="hljs-string">"key1"</span>
<span class="hljs-symbol">       operator:</span> <span class="hljs-string">"Equal"</span>
<span class="hljs-symbol">       value:</span> <span class="hljs-string">"value1"</span>
<span class="hljs-symbol">       effect:</span> <span class="hljs-string">"NoSchedule"</span>
<span class="hljs-symbol">     t2:</span>
<span class="hljs-symbol">       key:</span> <span class="hljs-string">"key1"</span>
<span class="hljs-symbol">       operator:</span> <span class="hljs-string">"Equal"</span>
<span class="hljs-symbol">       value:</span> <span class="hljs-string">"value1"</span>
<span class="hljs-symbol">       effect:</span> <span class="hljs-string">"NoExecute"</span>
</code></pre>
<p><h3><a class="anchor" aria-hidden="true" id="AuxResourceLimits-Policy"></a>AuxResourceLimits Policy</h3></p>
<p>You can specify the <em>AuxResourceLimits</em> which allow you to set limits on side cars.</p>
<pre><code class="hljs"><span class="hljs-attribute">apiVersion</span>: storage.k8s.io/v1
<span class="hljs-attribute">kind</span>: StorageClass
<span class="hljs-attribute">metadata</span>:
  <span class="hljs-attribute">annotations</span>:
    cas.openebs.io/<span class="hljs-attribute">config</span>: |
      - <span class="hljs-attribute">name</span>:  AuxResourceLimits
        <span class="hljs-attribute">value</span>: |-
            <span class="hljs-attribute">memory</span>: <span class="hljs-number">0.5</span>Gi
            <span class="hljs-attribute">cpu</span>: <span class="hljs-number">50</span>m
    openebs.io/<span class="hljs-attribute">cas-type</span>: cstor
</code></pre>
<p><h3><a class="anchor" aria-hidden="true" id="AuxResourceRequests-Policy"></a>AuxResourceRequests Policy</h3></p>
<p>This feature is useful in cases where user has to specify minimum requests like ephemeral storage etc. to avoid erroneous eviction by K8s. <code>AuxResourceRequests</code> allow you to set requests on side cars. Requests have to be specified in the format expected by Kubernetes</p>
<pre><code class="hljs"><span class="hljs-attribute">apiVersion</span>: storage.k8s.io/v1
<span class="hljs-attribute">kind</span>: StorageClass
<span class="hljs-attribute">metadata</span>:
  <span class="hljs-attribute">annotations</span>:
    cas.openebs.io/<span class="hljs-attribute">config</span>: |
      - <span class="hljs-attribute">name</span>: AuxResourceRequests
        <span class="hljs-attribute">value</span>: <span class="hljs-string">"none"</span>
    openebs.io/<span class="hljs-attribute">cas-type</span>: cstor
</code></pre>
<p><h3><a class="anchor" aria-hidden="true" id="Target-Affinity-Policy"></a>Target Affinity Policy</h3></p>
<p>The StatefulSet workloads access the OpenEBS storage volume  by connecting to the Volume Target Pod. This policy can be used to co-locate volume target pod on the same node as workload.</p>
<p>This feature makes use of the Kubernetes Pod Affinity feature that is dependent on the Pod labels. User will need to add the following label to both Application and PVC.</p>
<pre><code class="hljs">labels:
    openebs.io/target-affinity: &lt;application-unique-<span class="hljs-keyword">label</span><span class="bash">&gt;
</span></code></pre>
<p>You can specify the Target Affinity in both application and OpenEBS PVC using the following way
For Application Pod, it will be similar to the following</p>
<pre><code class="hljs">  <span class="hljs-attribute">apiVersion</span>: v1
  <span class="hljs-attribute">kind</span>: Pod
  <span class="hljs-attribute">metadata</span>:
    <span class="hljs-attribute">name</span>: fio-cstor
    <span class="hljs-attribute">labels</span>:
      <span class="hljs-attribute">name</span>: fio-cstor
      openebs.io/<span class="hljs-attribute">target-affinity</span>: fio-cstor
</code></pre>
<p><strong>Note</strong>: <em>This feature works only for cases where there is a 1-1 mapping between a application and PVC. It's not recommended for STS where PVC is specified as a template.</em></p>
<p><h3><a class="anchor" aria-hidden="true" id="Target-Namespace"></a>Target Namespace</h3></p>
<p>By default, the cStor target pods are scheduled in a dedicated <em>openebs</em> namespace. The target pod also is provided with OpenEBS service account so that it can access the Kubernetes Custom Resource called <code>CStorVolume</code> and <code>Events</code>.
This policy, allows the Cluster administrator to specify if the Volume Target pods should be deployed in the namespace of the workloads itself. This can help with setting the limits on the resources on the target pods, based on the namespace in which they are deployed.
To use this policy, the Cluster administrator could either use the existing OpenEBS service account or create a new service account with limited access and provide it in the StorageClass as follows:</p>
<pre><code class="hljs"><span class="hljs-attribute">annotations</span>:
    cas.openebs.io/<span class="hljs-attribute">config</span>: |
      - <span class="hljs-attribute">name</span>: PVCServiceAccountName
        <span class="hljs-attribute">value</span>: <span class="hljs-string">"user-service-account"</span>  
</code></pre>
<p>The sample service account can be found <a href="https://github.com/openebs/openebs/blob/master/k8s/ci/maya/volume/cstor/service-account.yaml">here</a>.</p>
<p><br></p>
<hr>
<p><br></p>
<h2><a class="anchor" aria-hidden="true" id="see-also"></a><a href="#see-also" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>See Also:</h2>
<p><a href="/docs/next/cstor.html#cstor-roadmap">cStor roadmap</a></p>
<p><br></p>
<hr>
<p><br></p>
<!-- Hotjar Tracking Code for https://docs.openebs.io -->
<script>
   (function(h,o,t,j,a,r){
       h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
       h._hjSettings={hjid:785693,hjsv:6};
       a=o.getElementsByTagName('head')[0];
       r=o.createElement('script');r.async=1;
       r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
       a.appendChild(r);
   })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-92076314-12"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
<p>gtag('config', 'UA-92076314-12');</p>
</script>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="configurepools.html">← Configuring Storage Pools</a><a class="docs-next button" href="provisionvols.html">Provisioning OpenEBS Storage Volumes →</a></div></div></div><nav class="onPageNav"><div id="global-on-page-heading"><h4 style="font-weight:400;">On this page:</h4><ul class="toc-headings"><li><a href="#using-sparse-storageclass">Using sparse StorageClass</a></li><li><a href="#creating-a-new-storageclass">Creating a new StorageClass</a></li><li><a href="#cstor-storage-policies">cStor storage policies</a></li><li><a href="#see-also">See Also:</a></li></ul></div></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><div><br/><div><a href="https://openebs.io" target="_blank"><img src="/docs/assets/openebs-logo.svg" alt="" width="130" height="110"/></a></div><div><a href="https://slack.openebs.io">Get in touch with OpenEBS community via Slack</a></div></div><div><br/><div><a href="https://mayadata.io" target="_blank"><img src="https://openebs.io/assets/images/mayadata.svg" alt="mayadata.io" width="130" height="110"/></a></div><div><a href="https://app.mayaonline.io">Get OpenEBS support through MayaOnline</a></div></div></section><section class="copyright"></section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
              var search = docsearch({
                
                apiKey: 'dc657dfe30f42f228671f557f49ced7a',
                indexName: 'openebs',
                inputSelector: '#search_input_react'
              });
            </script><script>(function(){ window.ldfdr = window.ldfdr || {}; (function(d, s, ss, fs){ fs = d.getElementsByTagName(s)[0]; function ce(src){ var cs = d.createElement(s); cs.async=1; cs.src = src; setTimeout(function(){fs.parentNode.insertBefore(cs,fs)}, 1); } ce(ss); })(document, 'script', 'https://lftracker.leadfeeder.com/lftracker_v1_bMwm7E2pzw4gOZyA.js'); })();</script></body></html>