<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Configuring Storage Pools · </title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta property="og:title" content="Configuring Storage Pools · "/><meta property="og:type" content="website"/><meta property="og:url" content="https://docs.openebs.io/index.html"/><meta property="og:description" content="------"/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/img/favicon.ico"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="stylesheet" href="/css/code-blocks-buttons.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/js/code-blocks-buttons.js"></script><link rel="stylesheet" href="/css/main.css"/></head><body class="sideNavVisible doc separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img id="logo" src="/img/OpenEBS-logo.svg" alt=""/><img class="logo-text" src="/img/openebs-docs-logo.svg" alt=""/><h2 class="headerTitle"></h2></a><div class="dropdown"><span class="ver-link">0.8.1</span><span class="ver-link-span"><i class="arrow down"></i></span><div class="dropdown-menu" id="versions-list" aria-labelledby="dropdownMenuButton"><a class="dropdown-item" id="0" href="https://docs.openebs.io">0.8.1</a><a class="dropdown-item" id="1" href="https://v08-docs.openebs.io">0.8.0</a><a class="dropdown-item" id="2" href="https://v07-docs.openebs.io">0.7.0</a><a class="dropdown-item" id="3" href="https://v06-docs.openebs.io">0.6.0</a><a class="dropdown-item" id="4" href="https://v05-docs.openebs.io">0.5.0</a></div></div><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><a href="https://app.mayaonline.io" target="_blank" rel="noreferrer noopener"><div class="float rotate"><img src="../../../../../../docs/assets/mo-logo.png" alt="MayaOnline" height="45px" width="45px" title="Connect to MayaOnline"/></div></a><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>User Guides</span></h2></div><div class="navGroups"><div class="navGroup navGroupActive"><h3 id="Introduction" class="languages-menu">Introduction</h3><div class="hide" id="Introduction dropdown-content-div"><ul id="languages-dropdown-items"><li class="navListItem"><a class="navItem" href="/docs/next/overview.html">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/next/features.html">Features and Benefits</a></li><li class="navListItem"><a class="navItem" href="/docs/next/usecases.html">Use cases</a></li><li class="navListItem"><a class="navItem" href="/docs/next/releases.html">Releases</a></li><li class="navListItem"><a class="navItem" href="/docs/next/support.html">Support</a></li><li class="navListItem"><a class="navItem" href="/docs/next/mayaonline.html">MayaOnline</a></li></ul></div></div><div class="navGroup navGroupActive"><h3 id="Concepts" class="languages-menu">Concepts</h3><div class="hide" id="Concepts dropdown-content-div"><ul id="languages-dropdown-items"><li class="navListItem"><a class="navItem" href="/docs/next/cas.html">Container Attached Storage</a></li><li class="navListItem"><a class="navItem" href="/docs/next/architecture.html">OpenEBS Architecture</a></li><li class="navListItem"><a class="navItem" href="/docs/next/casengines.html">CAS Engines (cStor &amp; Jiva)</a></li><li class="navListItem"><a class="navItem" href="/docs/next/cstor.html">cStor</a></li><li class="navListItem"><a class="navItem" href="/docs/next/jiva.html">Jiva</a></li></ul></div></div><div class="navGroup navGroupActive"><h3 id="User Guides" class="languages-menu">User Guides</h3><div class="hide" id="User Guides dropdown-content-div"><ul id="languages-dropdown-items"><li class="navListItem"><a class="navItem" href="/docs/next/quickstart.html">Quickstart</a></li><li class="navListItem"><a class="navItem" href="/docs/next/prerequisites.html">Prerequisites</a></li><li class="navListItem"><a class="navItem" href="/docs/next/installation.html">Installation</a></li><li class="navListItem navListItemActive"><a class="navItem navItemActive" href="/docs/next/configurepools.html">Configure StoragePools</a></li><li class="navListItem"><a class="navItem" href="/docs/next/configuresc.html">Configuring StorageClasses</a></li><li class="navListItem"><a class="navItem" href="/docs/next/provisionvols.html">Provisioning Volumes</a></li><li class="navListItem"><a class="navItem" href="/docs/next/operations.html">Day 2 Operations</a></li><li class="navListItem"><a class="navItem" href="/docs/next/jivaguide.html">Jiva user guide</a></li><li class="navListItem"><a class="navItem" href="/docs/next/mayactl.html">Mayactl</a></li><li class="navListItem"><a class="navItem" href="/docs/next/backup.html">Backup and Restore</a></li><li class="navListItem"><a class="navItem" href="/docs/next/upgrade.html">Upgrade</a></li><li class="navListItem"><a class="navItem" href="/docs/next/uninstall.html">Uninstall</a></li></ul></div></div><div class="navGroup navGroupActive"><h3 id="Stateful Applications" class="languages-menu">Stateful Applications</h3><div class="hide" id="Stateful Applications dropdown-content-div"><ul id="languages-dropdown-items"><li class="navListItem"><a class="navItem" href="/docs/next/mysql.html">RDS like MySQL</a></li><li class="navListItem"><a class="navItem" href="/docs/next/prometheus.html">Prometheus</a></li><li class="navListItem"><a class="navItem" href="/docs/next/minio.html">Minio</a></li><li class="navListItem"><a class="navItem" href="/docs/next/gitlab.html">GitLab</a></li><li class="navListItem"><a class="navItem" href="/docs/next/percona.html">Percona</a></li><li class="navListItem"><a class="navItem" href="/docs/next/elasticsearch.html">ElasticSearch</a></li><li class="navListItem"><a class="navItem" href="/docs/next/cassandra.html">Cassandra</a></li><li class="navListItem"><a class="navItem" href="/docs/next/nuodb.html">NuoDB</a></li><li class="navListItem"><a class="navItem" href="/docs/next/postgres.html">PostgreSQL</a></li><li class="navListItem"><a class="navItem" href="/docs/next/redis.html">Redis</a></li><li class="navListItem"><a class="navItem" href="/docs/next/mongo.html">MongoDB</a></li><li class="navListItem"><a class="navItem" href="/docs/next/rwm.html">Read-Write-Many (RWM)</a></li></ul></div></div><div class="navGroup navGroupActive"><h3 id="Advanced Topics" class="languages-menu">Advanced Topics</h3><div class="hide" id="Advanced Topics dropdown-content-div"><ul id="languages-dropdown-items"><li class="navListItem"><a class="navItem" href="/docs/next/performance.html">Performance testing</a></li><li class="navListItem"><a class="navItem" href="/docs/next/faq.html">FAQs</a></li><li class="navListItem"><a class="navItem" href="/docs/next/k8supgrades.html">Kubernetes upgrades</a></li><li class="navListItem"><a class="navItem" href="/docs/next/troubleshooting.html">Troubleshooting</a></li></ul></div></div></div></section></div><script>
          var toggler = document.getElementById('navToggler');
          var nav = document.getElementById('docsNav');
          toggler.onclick = function() {
            nav.classList.toggle('docsSliderActive');
          };
        </script><script>
            var navGroupElem = document.getElementsByClassName("hide");
            for(var k=0; k<navGroupElem.length; k++){
              if (navGroupElem[k].innerHTML.indexOf("navItem navItemActive") != -1) {
                document.getElementById(navGroupElem[k].id).className = "visible";
              }
            }
            var elem = document.getElementsByClassName("languages-menu");
            for (var i=0; i < elem.length; i++){
              document.getElementById(String(elem[i].id)).addEventListener("click", function() {
                sessionStorage.setItem("name", document.getElementById(this.id+" dropdown-content-div").className);
                sessionStorage.setItem("Id", document.getElementById(this.id).id);
                if ( document.getElementById(this.id+" dropdown-content-div").className == "hide") {
                  document.getElementById(this.id+" dropdown-content-div").className = "visible";
                }
                else {
                  document.getElementById(this.id+" dropdown-content-div").className = "hide";
                }
            })};</script><script>
          var SelectedItemClassName = sessionStorage.getItem("name");
          var SelectedItemId = sessionStorage.getItem("Id");
          if (SelectedItemClassName == "hide"){
            document.getElementById( SelectedItemId +" dropdown-content-div").className = "visible";
          }
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/openebs/openebs-docs/edit/staging/docs/configurepools.md" target="_blank" rel="noreferrer noopener">Edit</a><a class="edit-page-link button" href="https://github.com/openebs/openebs/issues/new/" target="_blank" rel="noreferrer noopener">Create An Issue</a><h1>Configuring Storage Pools</h1></header><article><div><span><hr>
<p><br></p>
<p><img src="/docs/assets/svg/2-config-sequence.svg" alt="OpenEBS configuration flow" style="width:100%"></p>
<p><br></p>
<p><font size="6">Summary:</font></p>
<p><a href="#using-default-cstor-pool">Using default pool</a></p>
<p><a href="#creating-a-new-pool">Creating a new pool</a></p>
<p><a href="#pool-policies">Pool policies</a></p>
<p><a href="#day-2-operations-on-cstorpools">Day 2 operations on cStorPools</a></p>
<p><a href="#verifying-pool-status">Verifying pool status</a></p>
<p><em>Note: This page describes how to create, use and maintain cStorPools. For details about Jiva pools, see <a href="/docs/next/jivaguide.html">Jiva user guide</a></em></p>
<p><br></p>
<hr>
<p><br></p>
<h2><a class="anchor" aria-hidden="true" id="using-default-cstor-pool"></a><a href="#using-default-cstor-pool" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Using default cStor pool</h2>
<p><br></p>
<p><code>openebs-cstor-sparse</code> storageClass and <code>cstor-sparse-pool</code> are created for convenience and ease of use. The data stored to this pool is stored on the sparse disks created during installation. This storageClass can be used in test setups and learning OpenEBS but not for production. For production use, create cStorPools on read disks.</p>
<p>If you want to know more details about sparse pools and disks, see <a href="#sparse-pool-deepdive">sparse pool deep dive</a></p>
<p><br></p>
<hr>
<p><br></p>
<h2><a class="anchor" aria-hidden="true" id="creating-a-new-pool"></a><a href="#creating-a-new-pool" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Creating a new pool</h2>
<p><br></p>
<p>Process of creating a new cStor storage pool</p>
<ul>
<li>Create a YAML spec <code>cstor-pool-config.yaml</code>. You can create a cStorPool in two ways.
<ul>
<li><a href="#manual-mode">By specifying disks list</a> (or)</li>
<li><a href="#auto-mode">Without specifying disks list</a> method</li>
</ul></li>
<li>Create pool config through <code>kubectl apply</code></li>
</ul>
<p><br></p>
<p><h3><a class="anchor" aria-hidden="true" id="manual-mode"></a>Create a cStorPool by specifying diskList </h3></p>
<p><strong>Step1:</strong></p>
<p>Create a YAML file called <code>cstor-pool1-config.yaml</code> with the following content. In the following YAML, <code>PoolResourceRequests</code> value is limted to <code>1Gi</code> and <code>PoolResourceLimits</code> value is set to <code>2Gi</code>. These values can be changed as per the Node configuration.</p>
<pre><code class="hljs"><span class="hljs-comment">#Use the following YAMLs to create a cStor Storage Pool.</span>
<span class="hljs-comment"># and associated storage class.</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">openebs.io/v1alpha1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">StoragePoolClaim</span>
<span class="hljs-attr">metadata:</span>
<span class="hljs-attr">  name:</span> <span class="hljs-string">cstor-pool1</span>
<span class="hljs-attr">  annotations:</span>
    <span class="hljs-string">cas.openebs.io/config:</span> <span class="hljs-string">|
</span><span class="hljs-attr">      - name:</span> <span class="hljs-string">PoolResourceRequests</span>
<span class="hljs-attr">        value:</span> <span class="hljs-string">|-</span>
<span class="hljs-attr">            memory:</span> <span class="hljs-number">1</span><span class="hljs-string">Gi</span>
<span class="hljs-attr">      - name:</span> <span class="hljs-string">PoolResourceLimits</span>
<span class="hljs-attr">        value:</span> <span class="hljs-string">|-</span>
<span class="hljs-attr">            memory:</span> <span class="hljs-number">1</span><span class="hljs-string">Gi</span>
<span class="hljs-attr">spec:</span>
<span class="hljs-attr">  name:</span> <span class="hljs-string">cstor-pool1</span>
<span class="hljs-attr">  type:</span> <span class="hljs-string">disk</span>
<span class="hljs-attr">  maxPools:</span> <span class="hljs-number">3</span>
<span class="hljs-attr">  poolSpec:</span>
<span class="hljs-attr">    poolType:</span> <span class="hljs-string">striped</span>
  <span class="hljs-comment"># NOTE - Appropriate disks need to be fetched using `kubectl get disks`</span>
  <span class="hljs-comment">#</span>
  <span class="hljs-comment"># `Disk` is a custom resource supported by OpenEBS with `node-disk-manager`</span>
  <span class="hljs-comment"># as the disk operator</span>
<span class="hljs-comment"># Replace the following with actual disk CRs from your cluster `kubectl get disks`</span>
<span class="hljs-comment"># Uncomment the below lines after updating the actual disk names.</span>
<span class="hljs-attr">  disks:</span>
<span class="hljs-attr">    diskList:</span>
<span class="hljs-comment"># Replace the following with actual disk CRs from your cluster from `kubectl get disks`</span>
<span class="hljs-comment">#   - disk-184d99015253054c48c4aa3f17d137b1</span>
<span class="hljs-comment">#   - disk-2f6bced7ba9b2be230ca5138fd0b07f1</span>
<span class="hljs-comment">#   - disk-806d3e77dd2e38f188fdaf9c46020bdc</span>
<span class="hljs-comment">#   - disk-8b6fb58d0c4e0ff3ed74a5183556424d</span>
<span class="hljs-comment">#   - disk-bad1863742ce905e67978d082a721d61</span>
<span class="hljs-comment">#   - disk-d172a48ad8b0fb536b9984609b7ee653</span>
<span class="hljs-meta">---</span>
</code></pre>
<p>In the above file, change the parameters as required</p>
<ul>
<li><p><code>poolType</code></p>
<p>This filed is not named very aptly. This field may be changed to <code>diskAggType</code> in future. This filed  represents how the data will be written to the disks on a given pool instance on a node. Supported values are <code>striped</code> or <code>mirrored</code></p></li>
</ul>
<p>Note: In OpenEBS, the pool instance do not extend beyond a node. The replication happens at volume level but not at pool level. See <a href="/docs/next/cstor.html#relationship-between-cstor-volumes-and-cstor-pools">volumes and pools relationship</a> in cStor for a deeper understanding.</p>
<ul>
<li><p><code>maxPools</code></p>
<p>This value represents the maximum number cStorPool instances to be created. In other words if <code>maxPools</code> is <code>3</code>, then three nodes are randomly chosen by OpenEBS and one cStorPool instance each is created on them  with one disk (<code>striped</code>) or two disks (<code>mirrored</code>)</p>
<p>This value should be less than or equal to the total number of Nodes in the cluster.</p></li>
<li><p><code>diskList</code></p>
<p>Select the list of disk CRs in each participating nodes and enter them under <code>diskList</code>. To get the list of disk CRs use <code>kubectl get disks</code> . To know which node a given disk CR belongs, use <code>kubectl describe disk &lt;disk-cr&gt;</code></p>
<p>You must enter all the disk CRs manually together from the selected nodes.</p>
<p>When the <code>poolType</code> = <code>mirrored</code> make sure the disk CRs selected from from each node are in even number.  The data is striped across mirrors. For example, if 4x1TB disks are selected on <code>node1</code>, the raw capacity of the pool instance of <code>cstor-pool1</code> on <code>node1</code> is 2TB.</p>
<p>When the <code>pooltype</code> = <code>striped</code> the number of disk CRs from each node can be in any number, the data is striped across each disk. For example, if 4x1TB disks are selected on <code>node1</code>, the raw capacity of the pool instance of <code>cstor-pool1</code> on that <code>node1</code> is 4TB.</p>
<p>The number of selected disk CRs across nodes need not be same. The disk CRs can be added to the pool spec dynamically as the used capacity gets filled up.</p>
<p>Note: Some of the pool expansion features of the cStorpools are under development. See <a href="#day2-operations-on-cstorpools">pool day2 operations</a></p></li>
<li><p><code>type</code></p>
<p>This value can be either <code>sparse</code> or <code>disk</code>.</p></li>
</ul>
<p><strong>Step2:</strong></p>
<p>After the pool YAML spec is created, run the following command to create the pool instances on nodes.</p>
<pre><code class="hljs">kubectl apply -f cstor-pool1-config<span class="hljs-selector-class">.yaml</span>
</code></pre>
<p>If the pool creation is successful, you will the example result as shown below.</p>
<div class="co">storagepoolclaim.openebs.io "cstor-pool1" created</div>
<p><strong>Note:</strong> You can horizontally scale up the cStor pool on new OpenEBS Node by editing  the corresponding pool configuration YAML with the new disks name under <code>diskList</code> and update the <code>maxPools</code> count. More details can be see <a href="/docs/next/operations.html#with-disklist">here</a>.</p>
<p><br></p>
<hr>
<p><br></p>
<p><h3><a class="anchor" aria-hidden="true" id="auto-mode"></a>Create a cStorPool WITHOUT specifying diskList </h3></p>
<p>Sometimes for new users, identifying the correct disks CRs and node-citizenship could be time consuming.  To make the process of cStorPool creation simple for users to quickly test cStor with real disks, OpenEBS supports creation of a cStorPool even when <code>diskList</code> is not specified in the YAML specification.  In this case, one pool instance on each node is created  with just one striped disk or one mirrored group of disks.</p>
<p>Follow the below steps to create a quick cStorPool in this method.</p>
<p><strong>Step1:</strong></p>
<p>Create a YAML file called <code>cstor-pool-config2.yaml</code> with the following content.  In the following YAML, <code>PoolResourceRequests</code> value is limted to <code>1Gi</code> and <code>PoolResourceLimits</code> value is set to <code>2Gi</code>. These values can be changed as per the Node configuration.</p>
<pre><code class="hljs"><span class="hljs-meta">---</span>
<span class="hljs-attr">apiVersion:</span> <span class="hljs-string">openebs.io/v1alpha1</span>
<span class="hljs-attr">kind:</span> <span class="hljs-string">StoragePoolClaim</span>
<span class="hljs-attr">metadata:</span>
<span class="hljs-attr">  name:</span> <span class="hljs-string">cstor-pool2</span>
<span class="hljs-attr">  annotations:</span>
    <span class="hljs-string">cas.openebs.io/config:</span> <span class="hljs-string">|
</span><span class="hljs-attr">      - name:</span> <span class="hljs-string">PoolResourceRequests</span>
<span class="hljs-attr">        value:</span> <span class="hljs-string">|-</span>
<span class="hljs-attr">            memory:</span> <span class="hljs-number">1</span><span class="hljs-string">Gi</span>
<span class="hljs-attr">      - name:</span> <span class="hljs-string">PoolResourceLimits</span>
<span class="hljs-attr">        value:</span> <span class="hljs-string">|-</span>
<span class="hljs-attr">            memory:</span> <span class="hljs-number">1</span><span class="hljs-string">Gi</span>
<span class="hljs-attr">spec:</span>
<span class="hljs-attr">  name:</span> <span class="hljs-string">cstor-pool2</span>
<span class="hljs-attr">  type:</span> <span class="hljs-string">disk</span>
<span class="hljs-attr">  maxPools:</span> <span class="hljs-number">3</span>
<span class="hljs-attr">  poolSpec:</span>
<span class="hljs-attr">    poolType:</span> <span class="hljs-string">striped</span>
<span class="hljs-meta">---</span>
</code></pre>
<ul>
<li><p><code>type</code></p>
<p>This value can be either <code>sparse</code> or <code>disk</code>.</p></li>
<li><p><code>maxPools</code></p>
<p>This value represents the maximum number cStorPool instances to be created. In other words if <code>maxPools</code> is <code>3</code>, then three nodes are randomly chosen by OpenEBS and one cStorPool instance each is created on them  with one disk (<code>striped</code>) or two disks (<code>mirrored</code>)</p>
<p>This value should be less than or equal to the total number of Nodes in the cluster.</p></li>
<li><p><code>poolType</code></p>
<p>This filed is not named very aptly. This field may be changed to <code>diskAggType</code> in future. This filed  represents how the data will be written to the disks on a given pool instance on a node. Supported values are <code>striped</code> or <code>mirrored</code></p></li>
</ul>
<p>Note: In OpenEBS, the pool instance do not extend beyond a node. The replication happens at volume level but not at pool level. See <a href="/docs/next/cstor.html#relationship-between-cstor-volumes-and-cstor-pools">volmes and pools relationship</a> in cStor for a deeper understanding.</p>
<p><strong>Step2:</strong></p>
<p>After the pool YAML spec is created, run the following command to create the pool instances on nodes.</p>
<pre><code class="hljs">kubectl apply -f cstor-pool2-config<span class="hljs-selector-class">.yaml</span>
</code></pre>
<p>If the pool creation is successful, you will the example result as shown below.</p>
<div class="co">storagepoolclaim.openebs.io "cstor-pool2" created</div>
<p><strong>Note:</strong> You can horizontally scale up the cStor pool on new OpenEBS Node by editing the corresponding pool configuration YAML with updating the <code>maxPools</code> count. More details can be see <a href="/docs/next/operations.html#without-disklist">here</a>.</p>
<p><br></p>
<hr>
<br>
<h2><a class="anchor" aria-hidden="true" id="pool-policies"></a><a href="#pool-policies" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Pool Policies</h2>
<p>This section captures the policies supported for cStorPools in <code>StoragePoolClaim</code> under <code>spec</code>  in the name and value pair format.</p>
<p><h3><a class="anchor" aria-hidden="true" id="PoolResourceLimits-Policy"></a>PoolResourceLimits Policy</h3></p>
<p>This feature allow you to set the limits on memory and cpu for pool pods. The resource and limit value should be in the same format as expected by Kubernetes. The <code>name</code> of SPC can be changed if you need.</p>
<pre><code class="hljs"><span class="hljs-attribute">apiVersion</span>: openebs.io/v1alpha1
<span class="hljs-attribute">kind</span>: StoragePoolClaim
<span class="hljs-attribute">metadata</span>:
  <span class="hljs-attribute">name</span>: cstor-disk
  <span class="hljs-attribute">annotations</span>:
    cas.openebs.io/<span class="hljs-attribute">config</span>: |
      - <span class="hljs-attribute">name</span>: PoolResourceRequests
        <span class="hljs-attribute">value</span>: |-
            <span class="hljs-attribute">memory</span>: <span class="hljs-number">1</span>Gi
<span class="hljs-attribute">spec</span>:
  <span class="hljs-attribute">name</span>: cstor-pool-prom1
  <span class="hljs-attribute">type</span>: disk
</code></pre>
<p><h3><a class="anchor" aria-hidden="true" id="PoolResourceRequests-Policy"></a>PoolResourceRequests Policy</h3></p>
<p>This feature allow you to specify resource requests that need to be available before scheduling the containers. If not specified, the default is to use the limits from PoolResourceLimits or the default requests set in the cluster. The <code>name</code> of SPC can be changed if you need.</p>
<pre><code class="hljs"><span class="hljs-attribute">apiVersion</span>: openebs.io/v1alpha1
<span class="hljs-attribute">kind</span>: StoragePoolClaim
<span class="hljs-attribute">metadata</span>:
  <span class="hljs-attribute">name</span>: cstor-disk
  <span class="hljs-attribute">annotations</span>:
    cas.openebs.io/<span class="hljs-attribute">config</span>: |
      - <span class="hljs-attribute">name</span>: PoolResourceLimits
        <span class="hljs-attribute">value</span>: |-
            <span class="hljs-attribute">memory</span>: <span class="hljs-number">1</span>Gi
<span class="hljs-attribute">spec</span>:
  <span class="hljs-attribute">name</span>: cstor-pool-prom1
  <span class="hljs-attribute">type</span>: disk
</code></pre>
<p><br></p>
<hr>
<p><br></p>
<h2><a class="anchor" aria-hidden="true" id="day-2-operations-on-cstorpools"></a><a href="#day-2-operations-on-cstorpools" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Day 2 operations on cStorPools</h2>
<p>In 0.8.1 , only some day2 operations are supported. Many day2 operations are under active development. See <a href="docs/next/cstor.html#cstor-roadmap">cStor roadmap</a> for more details.</p>
<p><strong>Note:</strong> <em>All pools created using 0.8.1 will receive the pool expansion capabilities when those features are available in future releases.</em></p>
<p><br></p>
<hr>
<p><br></p>
<h2><a class="anchor" aria-hidden="true" id="verifying-pool-status"></a><a href="#verifying-pool-status" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Verifying pool status</h2>
<p><br></p>
<p>Detailed metrics for cStorPool are under development. See <a href="/docs/next/cstor.html#cstor-roadmap">cStor Roadmap</a> for more details.</p>
<p>At the moment, status of cStor pools is obtained via the standard <code>kubectl get</code> and <code>kubectl describe</code> commands of pool  custom resources (spc, csp)</p>
<p><strong>StoragePoolClaim status</strong></p>
<pre><code class="hljs"> kubectl <span class="hljs-builtin-name">get</span> spc
</code></pre>
<p>Following is an example output.</p>
<div class="co">NAME                AGE
cstor-disk          1m
cstor-sparse-pool   22m
</div>
<p><strong>cStorStoragePool status</strong></p>
<p>Once StoragePoolClaim is created, corresponding cStorStoragePool will be created. This can be check using the following command.</p>
<pre><code class="hljs">kubectl <span class="hljs-builtin-name">get</span> csp
</code></pre>
<p>Following is an example output.</p>
<div class="co">NAME                     AGE
cstor-disk-8qvy          5s
cstor-disk-k6si          6s
cstor-disk-tns6          6s
cstor-sparse-pool-a8qk   21m
cstor-sparse-pool-d1zm   21m
cstor-sparse-pool-sbv5   21m
</div>
<p><strong>cStorStoragePool pods status</strong></p>
<p>Once cStorStoragePool is created, corresponding pool pods will be created and running. This can be verified using the following command.</p>
<pre><code class="hljs">kubectl <span class="hljs-builtin-name">get</span> pods -n openebs
</code></pre>
<p>Following is an example output.</p>
<div class="co">cstor-disk-2xtj-6748d7f57d-tbqrp           2/2       Running   0          38s
cstor-disk-m7xa-6f7bd8447c-nr5z4           2/2       Running   0          38s
cstor-disk-sn5y-5688f94888-hmgkf           2/2       Running   0          38s
cstor-sparse-pool-io1y-88cbf9bc-c6g29      2/2       Running   0          21m
cstor-sparse-pool-lsm9-766567747b-rfplx    2/2       Running   0          21m
cstor-sparse-pool-y8pf-598d794ff4-jn8gg    2/2       Running   0          21m
maya-apiserver-5f8899f44f-hbnj2            1/1       Running   0          22m
openebs-ndm-6w68f                          1/1       Running   0          22m
openebs-ndm-9ktvv                          1/1       Running   0          22m
openebs-ndm-g4d6l                          1/1       Running   0          22m
openebs-provisioner-69956599d5-jlnb4       1/1       Running   0          22m
openebs-snapshot-operator-c88544f5-76px8   2/2       Running   0          22m
</div>
<p>In the above example output, name starts with <code>cstor-disk-\*</code> are the cStorStoragePool pods. It must be in running state to provision cStor Volumes.</p>
<p><strong>Note:</strong> By default, OpenEBS cStorStoragePool pods will be running in <code>openebs</code> namespace.</p>
<p><br></p>
<hr>
<p><br></p>
<p><h2><a class="anchor" aria-hidden="true" id="sparse-pool-deepdive"></a>Sparse Pool deep dive </h2></p>
<p>OpenEBS installation process creates the following defaults :</p>
<ul>
<li>One sparse disk is created on each node in the cluster</li>
<li>A ready to use cStorPool config called <code>cstor-sparse-pool</code> .  This <code>cstor-sparse-pool</code> config has a <code>cStor Pool</code> instance on every node of the cluster.</li>
<li>One StorageClass called <code>openebs-cstor-sparse</code> that points to <code>cstor-sparse-pool</code></li>
</ul>
<p><img src="/docs/assets/svg/sparsepool.svg" alt="OpenEBS configuration flow" style="width:100%"></p>
<p><code>kubectl describe StorageClass openebs-cstor-sparse</code> provides the relationship  details</p>
<div class="co">
<p>Name:            openebs-cstor-sparse
IsDefaultClass:  No
Annotations:     cas.openebs.io/config=- name: StoragePoolClaim
value: &quot;cstor-sparse-pool&quot;
-name: ReplicaCount
value: &quot;3&quot;
,openebs.io/cas-type=cstor
Provisioner:           openebs.io/provisioner-iscsi
Parameters:            <none>
AllowVolumeExpansion:  <unset>
MountOptions:          <none>
ReclaimPolicy:         Delete
VolumeBindingMode:     Immediate
Events:                <none></p>
</div>
<p>cStor provides storage scalability along with ease of deployment and usage. cStor can handle multiple disks with different size per Node and create different storage pools. You can use these storage pools to create cStor volumes which you can utilize to run your stateful applications.</p>
<p><br></p>
<hr>
<p><br></p>
<h2><a class="anchor" aria-hidden="true" id="see-also"></a><a href="#see-also" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>See Also:</h2>
<h3><a class="anchor" aria-hidden="true" id="understand-cstorpools-docs-next-cstorhtml-cstor-pools"></a><a href="#understand-cstorpools-docs-next-cstorhtml-cstor-pools" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><a href="/docs/next/cstor.html#cstor-pools">Understand cStorPools </a></h3>
<h3><a class="anchor" aria-hidden="true" id="cstorpool-use-case-for-prometheus-docs-next-prometheushtml"></a><a href="#cstorpool-use-case-for-prometheus-docs-next-prometheushtml" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><a href="/docs/next/prometheus.html">cStorPool use case for Prometheus</a></h3>
<h3><a class="anchor" aria-hidden="true" id="cstor-roadmap-docs-next-cstorhtml-cstor-roadmap"></a><a href="#cstor-roadmap-docs-next-cstorhtml-cstor-roadmap" aria-hidden="true" class="hash-link" ><svg aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><a href="/docs/next/cstor.html#cstor-roadmap">cStor roadmap</a></h3>
<p><br></p>
<hr>
<p><br></p>
<!-- Hotjar Tracking Code for https://docs.openebs.io -->
<script>
   (function(h,o,t,j,a,r){
       h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
       h._hjSettings={hjid:785693,hjsv:6};
       a=o.getElementsByTagName('head')[0];
       r=o.createElement('script');r.async=1;
       r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
       a.appendChild(r);
   })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-92076314-12"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-92076314-12');
</script></span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="installation.html">← Installing OpenEBS</a><a class="docs-next button" href="configuresc.html">Configuring Storage Classes →</a></div></div></div><nav class="onPageNav"><div id="global-on-page-heading"><h4 style="font-weight:400;">On this page:</h4><ul class="toc-headings"><li><a href="#using-default-cstor-pool">Using default cStor pool</a></li><li><a href="#creating-a-new-pool">Creating a new pool</a></li><li><a href="#pool-policies">Pool Policies</a></li><li><a href="#day-2-operations-on-cstorpools">Day 2 operations on cStorPools</a></li><li><a href="#verifying-pool-status">Verifying pool status</a></li><li><a href="#see-also">See Also:</a><ul class="toc-headings"><li><a href="#understand-cstorpools-docs-next-cstorhtml-cstor-pools">Understand cStorPools</a></li><li><a href="#cstorpool-use-case-for-prometheus-docs-next-prometheushtml">cStorPool use case for Prometheus</a></li><li><a href="#cstor-roadmap-docs-next-cstorhtml-cstor-roadmap">cStor roadmap</a></li></ul></li></ul></div></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><div><br/><div><a href="https://openebs.io" target="_blank"><img src="/docs/assets/openebs-logo.svg" alt="" width="130" height="110"/></a></div><div><a href="https://slack.openebs.io">Get in touch with OpenEBS community via Slack</a></div></div><div><br/><div><a href="https://mayadata.io" target="_blank"><img src="https://openebs.io/assets/images/mayadata.svg" alt="mayadata.io" width="130" height="110"/></a></div><div><a href="https://app.mayaonline.io">Get OpenEBS support through MayaOnline</a></div></div></section><section class="copyright"></section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
              var search = docsearch({
                
                apiKey: 'dc657dfe30f42f228671f557f49ced7a',
                indexName: 'openebs',
                inputSelector: '#search_input_react'
              });
            </script><script>(function(){ window.ldfdr = window.ldfdr || {}; (function(d, s, ss, fs){ fs = d.getElementsByTagName(s)[0]; function ce(src){ var cs = d.createElement(s); cs.async=1; cs.src = src; setTimeout(function(){fs.parentNode.insertBefore(cs,fs)}, 1); } ce(ss); })(document, 'script', 'https://lftracker.leadfeeder.com/lftracker_v1_bMwm7E2pzw4gOZyA.js'); })();</script></body></html>